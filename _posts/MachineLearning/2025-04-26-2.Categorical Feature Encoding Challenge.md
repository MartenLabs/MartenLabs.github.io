---
title: 2. Categorical Feature Encoding Challenge
date: 2025-04-26T09:30:00+09:00
categories: [Machine Learning, Part3]
tags:
  [
    Machine Learning,
    ì´ë¡ ,
    ê°œë…,
    ì´ì§„ë¶„ë¥˜, 
    ë¡œì§€ìŠ¤í‹± íšŒê·€
  ]
pin: true
math: true
mermaid: true
share: true 
comments: true
---

# 2. Categorical Feature Encoding Challenge

<br/>

- [ë²”ì£¼í˜• ë°ì´í„° ì´ì§„ë¶„ë¥˜ ê²½ì§„ëŒ€íšŒ ë§í¬](https://www.kaggle.com/c/cat-in-the-dat/)  

- [íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ ì½”ë“œ ì°¸ê³  ë§í¬](https://www.kaggle.com/kabure/eda-feat-engineering-encode-conquer)

<br/>


| ë‚œì´ë„         | 2                                                                                                                    |      |         |     |
| ----------- | -------------------------------------------------------------------------------------------------------------------- | ---- | ------- | --- |
| ê²½ì§„ëŒ€íšŒëª…       | ë²”ì£¼í˜• ë°ì´í„° ì´ì§„ë¶„ë¥˜ ê²½ì§„ëŒ€íšŒ                                                                                                    |      |         |     |
| ë¯¸ì…˜          | ë‹¤ì–‘í•œ ë²”ì£¼í˜• ë°ì´í„°ë¥¼ í™œìš©í•´ íƒ€ê²Ÿê°’ 1ì— ì†í•  í™•ë¥  ì˜ˆì¸¡                                                                                     |      |         |     |
| ë¬¸ì œìœ í˜•        | ì´ì§„ë¶„ë¥˜                                                                                                                 | í‰ê°€ì§€í‘œ | ROC AUC |     |
| ì œì¶œì‹œ ì‚¬ìš©í•œ ëª¨ë¸  | ë¡œì§€ìŠ¤í‹± íšŒê·€                                                                                                              |      |         |     |
| íŒŒì´ì¬ ë²„ì „      | 3.7.10                                                                                                               |      |         |     |
| ì‚¬ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ | numpy == 1.19.5<br>pandas == 1.3.2<br>seaborn == 0.11.2<br>matplotlib == 3.4.3<br>sklearn == 0.32.2<br>scipy ==1.7.1 |      |         |     |

<br/>

### í•™ìŠµ ëª©í‘œ 
- ë²”ì£¼í˜• ë°ì´í„°ë¥¼ í™œìš©í•´ ì´ì§„ë¶„ë¥˜í•˜ëŠ” ê²½ì§„ëŒ€íšŒì— ì°¸ê°€
- í”¼ì²˜ êµ¬ì„±ì„ ì´í•´í•˜ê¸° ìœ„í•´ íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ì„ ìì„¸íˆ í•™ìŠµ
- ë°ì´í„° íŠ¹ì„±ì— ë”°ë¥¸ ë§ì¶¤í˜• ì¸ì½”ë”© ë°©ë²• í•™ìŠµ
- ìµœì¢…ì ìœ¼ë¡œ í”„ë¼ì´ë¹— ë¦¬ë”ë³´ë“œì—ì„œ 2ë“±ì„ ê¸°ë¡í•˜ëŠ” ëª¨ë¸ ì œì‘

<br/>

### í•™ìŠµ ìˆœì„œ 
1. ê²½ì§„ëŒ€íšŒ ì´í•´ 
2. íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ 
3. ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸(ë¡œì§€ìŠ¤í‹± íšŒê·€)
4. ì„±ëŠ¥ê°œì„  I (í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ ê°•í™”)
5. ì„±ëŠ¥ ê°œì„  II (ê²€ì¦ ë°ì´í„°ê¹Œì§€ í›ˆë ¨ì— ì´ìš©)

<br/>

### í•™ìŠµ í‚¤ì›Œë“œ
- **ìœ í˜• ë° í‰ê°€ ì§€í‘œ** : ì´ì§„ë¶„ë¥˜, ROC AUC
- **íƒìƒ‰ì  ë°ì´í„° ë¶„ì„** : í”¼ì²˜ ìš”ì•½í‘œ, íƒ€ê²Ÿê°’ ë¶„í¬, ì´ì§„/ëª…ëª©í˜•/ìˆœì„œí˜•/ë‚ ì§œ í”¼ì²˜ ë¶„í¬
- **ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸** : ë¡œì§€ìŠ¤í‹± íšŒê·€
- **í”¼ì²˜ ì•¤ì§€ë‹ˆì–´ë§** : ì›-í•« ì¸ì½”ë”©, í”¼ì²˜ ë§ì¶¤ ì¸ì½”ë”©, í”¼ì²˜ ìŠ¤ì¼€ì¼ë§
- **í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”** : ê·¸ë¦¬ë“œ ì„œì¹˜ 

<br/>
<br/>
<br/>

---
## 1. ê²½ì§„ëŒ€íšŒ ì´í•´

- ë³¸ ëŒ€íšŒì˜ ëª©í‘œëŠ” ë²”ì£¼í˜• feature 23ê°œë¥¼ í™œìš©í•´ í•´ë‹¹ ë°ì´í„°ê°€ íƒ€ê²Ÿê°’ 1ì— ì†í•  í™•ë¥ ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë‹¤.

<br/>

- ë³¸ ê²½ì§„ëŒ€íšŒì˜ íŠ¹ì§•
	- ë³¸ ëŒ€íšŒëŠ” ì¸ìœ„ì ìœ¼ë¡œ ë§Œë“  ë°ì´í„°ë¥¼ ì œê³µí•œë‹¤. (ì—°ìŠµìš©ìœ¼ë¡œëŠ” ì¸ê³µ ë°ì´í„°ê°€ ì˜¤íˆë ¤ ì¢‹ë‹¤.)

	- ê° í”¼ì²˜ì™€ íƒ€ê²Ÿê°’ì˜ ì˜ë¯¸ë¥¼ ì•Œ ìˆ˜ ì—†ë‹¤.  ìì „ê±° ëŒ€ì—¬ ìˆ˜ìš” ì˜ˆì¸¡ì€ ë‹¤ë¥´ê²Œ ë‚ ì”¨ê°€ ì¢‹ì„ìˆ˜ë¡ ìì „ê±° ëŒ€ì—¬ ìˆ˜ëŸ‰ì´ ë§ì„ê²ƒì´ë¼ ì˜ˆìƒí•  ìˆ˜ ìˆì—ˆì§€ë§Œ ì´ëŸ° ê²½ìš° í™œìš©í•  ìˆ˜ ìˆëŠ” ë°°ê²½ ì§€ì‹ì´ ì—†ê¸° ë•Œë¬¸ì— ìˆœì „íˆ ë°ì´í„°ë§Œ ë³´ê³  ì ‘ê·¼í•´ì•¼ í•œë‹¤.

	- ì œê³µë˜ëŠ” ë°ì´í„°ê°€ ëª¨ë‘ ë²”ì£¼í˜•ì´ë‹¤. ê°’ì´ ë‘ê°œë¡œë§Œ êµ¬ì„±ëœ ë°ì´í„°ë¶€í„° ìˆœì„œí˜• ë°ì´í„°(ordinal data), ëª…ëª©í˜• ë°ì´í„°(nominal data), ë‚ ì§œ ë°ì´í„°ê¹Œì§€ ë‹¤ì–‘í•˜ê²Œ ì œê³µëœë‹¤. 
		- bin_ë¡œ ì‹œì‘í•˜ëŠ” í”¼ì²˜ëŠ” ì´ì§„ í”¼ì²˜, nom_ë¡œ ì‹œì‘í•˜ëŠ” í”¼ì²˜ëŠ” ëª…ëª©í˜• í”¼ì²˜, ord_ë¡œ ì‹œì‘í•˜ëŠ” í”¼ì²˜ëŠ” ìˆœì„œí˜• í”¼ì²˜ì´ë‹¤.
		- ìˆœì„œí˜• í”¼ì²˜ ì¤‘ ord_3, ord_4, ord_5 ëŠ” ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ê³ ìœ³ê°’ ìˆœì„œê°€ ë§¤ì ¸ìˆë‹¤.

	- íƒ€ê²Ÿê°’ë„ ë²”ì£¼í˜• ë°ì´í„° ì´ë‹¤. 0ê³¼ 1 ë‘ê°œë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.

<br/>

#### í™•ë¥  ì˜ˆì¸¡

> ë¶„ë¥˜ ë¬¸ì œì—ì„œëŠ” íƒ€ê²Ÿê°’ì´ 0ì´ëƒ 1ì´ëƒê°€ ì•„ë‹ˆë¼ '1ì¼ í™•ë¥ 'ì„ ì˜ˆì¸¡í•œë‹¤. 
ë³´í†µ ìŒì„± ê°’ì¼ í™•ë¥ ë³´ë‹¤ëŠ” ì–‘ì„± ê°’ì¼ í™•ë¥ ë¡œ ì˜ˆì¸¡í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ 0ì€ ìŒì„±, 1ì€ ì–‘ì„±ì„ ë‚˜íƒ€ë‚¸ë‹¤. ìŠ¤íŒ¸ ë©”ì¼ì„ ê±°ë¥´ëŠ” ë¬¸ì œë¼ë©´ 0ì€ ì¼ë°˜ ë©”ì¼, 1ì€ ìŠ¤íŒ¸ ë©”ì¼ì„ ëœ»í•œë‹¤. ì•”ì„ ì§„ë‹¨í•˜ëŠ” ë¬¸ì œì—ì„œë„ 0ì€ ì •ìƒ, 1ì€ ì•” ì§„ë‹¨ì„ ì˜ë¯¸í•œë‹¤. ì´ëŸ° ë¬¸ì œë“¤ì—ì„œ ìš°ë¦¬ê°€ ì•Œê³ ì‹¶ì€ê±´ ìŠ¤íŒ¸ ë©”ì¼ì¼ í™•ë¥ ì´ë‚˜ ì•”ì¼ í™•ë¥ ì´ê¸° ë•Œë¬¸ì— ì–‘ì„±ê°’ì¸ 1ì¼ í™•ë¥ ì„ ì˜ˆì¸¡í•œë‹¤.


<br/>
<br/>
<br/>

## 2. íƒìƒ‰ì  ë°ì´í„° ë¶„ì„

ë¶„ì„ ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ì€ ìˆœì„œë¡œ ì§„í–‰ëœë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/1.jpeg" width="70%" height="70%"></p>

<br/>

### 2.1 íƒìƒ‰ì  ë°ì´í„° ë¶„ì„

> kaggle competitions download -c cat-in-the-dat

<br/>
<br/>

#### ë°ì´í„° ë¡œë“œ ë° shape í™•ì¸ 

ë°ì´í„°ë¥¼ ì½ì–´ì˜¬ ë•Œ index_col íŒŒë¼ë¯¸í„°ì— ë°ì´í„°ê°€ ê°€ì§€ê³  ìˆëŠ” idë¥¼ ì „ë‹¬í–ˆë‹¤. ì—´ ì´ë¦„ì„ ì „ë‹¬í•˜ë©´ í•´ë‹¹ ì—´ì„ ì¸ë±ìŠ¤ë¡œ ì§€ì •í•˜ë©° ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ 0ë¶€í„° ì‹œì‘í•˜ëŠ” ìƒˆë¡œìš´ ì—´ì„ ìƒì„±í•´ì¤€ë‹¤.


``` python
import pandas as pd
import numpy as np

data_path = 'datasets/'

train = pd.read_csv(data_path + 'train.csv', index_col = 'id')
test = pd.read_csv(data_path + 'test.csv', index_col = 'id')
submission = pd.read_csv(data_path + 'sample_submission.csv', index_col = 'id')

print(train.shape, test.shape)

'''
(300000, 24) (200000, 23)
'''
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/2.jpeg" width="70%" height="70%"></p>


<br/>
<br/>

train, test, submissionì˜ ì²« 5í–‰ ì¶œë ¥ 

``` python
train.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bin_0</th>
      <th>bin_1</th>
      <th>bin_2</th>
      <th>bin_3</th>
      <th>bin_4</th>
      <th>nom_0</th>
      <th>nom_1</th>
      <th>nom_2</th>
      <th>nom_3</th>
      <th>nom_4</th>
      <th>...</th>
      <th>nom_9</th>
      <th>ord_0</th>
      <th>ord_1</th>
      <th>ord_2</th>
      <th>ord_3</th>
      <th>ord_4</th>
      <th>ord_5</th>
      <th>day</th>
      <th>month</th>
      <th>target</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>T</td>
      <td>Y</td>
      <td>Green</td>
      <td>Triangle</td>
      <td>Snake</td>
      <td>Finland</td>
      <td>Bassoon</td>
      <td>...</td>
      <td>2f4cb3d51</td>
      <td>2</td>
      <td>Grandmaster</td>
      <td>Cold</td>
      <td>h</td>
      <td>D</td>
      <td>kr</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>T</td>
      <td>Y</td>
      <td>Green</td>
      <td>Trapezoid</td>
      <td>Hamster</td>
      <td>Russia</td>
      <td>Piano</td>
      <td>...</td>
      <td>f83c56c21</td>
      <td>1</td>
      <td>Grandmaster</td>
      <td>Hot</td>
      <td>a</td>
      <td>A</td>
      <td>bF</td>
      <td>7</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>F</td>
      <td>Y</td>
      <td>Blue</td>
      <td>Trapezoid</td>
      <td>Lion</td>
      <td>Russia</td>
      <td>Theremin</td>
      <td>...</td>
      <td>ae6800dd0</td>
      <td>1</td>
      <td>Expert</td>
      <td>Lava Hot</td>
      <td>h</td>
      <td>R</td>
      <td>Jc</td>
      <td>7</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>F</td>
      <td>Y</td>
      <td>Red</td>
      <td>Trapezoid</td>
      <td>Snake</td>
      <td>Canada</td>
      <td>Oboe</td>
      <td>...</td>
      <td>8270f0d71</td>
      <td>1</td>
      <td>Grandmaster</td>
      <td>Boiling Hot</td>
      <td>i</td>
      <td>D</td>
      <td>kW</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>F</td>
      <td>N</td>
      <td>Red</td>
      <td>Trapezoid</td>
      <td>Lion</td>
      <td>Canada</td>
      <td>Oboe</td>
      <td>...</td>
      <td>b164b72a7</td>
      <td>1</td>
      <td>Grandmaster</td>
      <td>Freezing</td>
      <td>a</td>
      <td>R</td>
      <td>qP</td>
      <td>7</td>
      <td>8</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 24 columns</p>
</div>

<br/>
<br/>

train.head()ë¡œ ì¶œë ¥í•˜ë©´ ì¤‘ê°„ì— í”¼ì²˜ê°€ ìƒëµëœ ìƒíƒœë¡œ ì¶œë ¥ë¼ ë³´ê¸° ë¶ˆí¸í•˜ë‹¤. ì´ë•Œ T ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ í•œëˆˆì— ë³´ê¸° í¸í•˜ê²Œ í–‰ê³¼ ì—´ì˜ ìœ„ì¹˜ê°€ ë°”ë€ë‹¤.

``` python
train.head().T
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>id</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bin_0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>bin_1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>bin_2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>bin_3</th>
      <td>T</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>F</td>
    </tr>
    <tr>
      <th>bin_4</th>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
      <td>N</td>
    </tr>
    <tr>
      <th>nom_0</th>
      <td>Green</td>
      <td>Green</td>
      <td>Blue</td>
      <td>Red</td>
      <td>Red</td>
    </tr>
    <tr>
      <th>nom_1</th>
      <td>Triangle</td>
      <td>Trapezoid</td>
      <td>Trapezoid</td>
      <td>Trapezoid</td>
      <td>Trapezoid</td>
    </tr>
    <tr>
      <th>nom_2</th>
      <td>Snake</td>
      <td>Hamster</td>
      <td>Lion</td>
      <td>Snake</td>
      <td>Lion</td>
    </tr>
    <tr>
      <th>nom_3</th>
      <td>Finland</td>
      <td>Russia</td>
      <td>Russia</td>
      <td>Canada</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>nom_4</th>
      <td>Bassoon</td>
      <td>Piano</td>
      <td>Theremin</td>
      <td>Oboe</td>
      <td>Oboe</td>
    </tr>
    <tr>
      <th>nom_5</th>
      <td>50f116bcf</td>
      <td>b3b4d25d0</td>
      <td>3263bdce5</td>
      <td>f12246592</td>
      <td>5b0f5acd5</td>
    </tr>
    <tr>
      <th>nom_6</th>
      <td>3ac1b8814</td>
      <td>fbcb50fc1</td>
      <td>0922e3cb8</td>
      <td>50d7ad46a</td>
      <td>1fe17a1fd</td>
    </tr>
    <tr>
      <th>nom_7</th>
      <td>68f6ad3e9</td>
      <td>3b6dd5612</td>
      <td>a6a36f527</td>
      <td>ec69236eb</td>
      <td>04ddac2be</td>
    </tr>
    <tr>
      <th>nom_8</th>
      <td>c389000ab</td>
      <td>4cd920251</td>
      <td>de9c9f684</td>
      <td>4ade6ab69</td>
      <td>cb43ab175</td>
    </tr>
    <tr>
      <th>nom_9</th>
      <td>2f4cb3d51</td>
      <td>f83c56c21</td>
      <td>ae6800dd0</td>
      <td>8270f0d71</td>
      <td>b164b72a7</td>
    </tr>
    <tr>
      <th>ord_0</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>ord_1</th>
      <td>Grandmaster</td>
      <td>Grandmaster</td>
      <td>Expert</td>
      <td>Grandmaster</td>
      <td>Grandmaster</td>
    </tr>
    <tr>
      <th>ord_2</th>
      <td>Cold</td>
      <td>Hot</td>
      <td>Lava Hot</td>
      <td>Boiling Hot</td>
      <td>Freezing</td>
    </tr>
    <tr>
      <th>ord_3</th>
      <td>h</td>
      <td>a</td>
      <td>h</td>
      <td>i</td>
      <td>a</td>
    </tr>
    <tr>
      <th>ord_4</th>
      <td>D</td>
      <td>A</td>
      <td>R</td>
      <td>D</td>
      <td>R</td>
    </tr>
    <tr>
      <th>ord_5</th>
      <td>kr</td>
      <td>bF</td>
      <td>Jc</td>
      <td>kW</td>
      <td>qP</td>
    </tr>
    <tr>
      <th>day</th>
      <td>2</td>
      <td>7</td>
      <td>7</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>month</th>
      <td>2</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¸ë±ìŠ¤ê°€ 300,000 ë¶€í„° ì‹œì‘í•˜ê¸° ë•Œë¬¸ì— submission idëŠ” 300,000 ë¶€í„° ì‹œì‘í•œë‹¤.

``` python
submission.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>300000</th>
      <td>0.5</td>
    </tr>
    <tr>
      <th>300001</th>
      <td>0.5</td>
    </tr>
    <tr>
      <th>300002</th>
      <td>0.5</td>
    </tr>
    <tr>
      <th>300003</th>
      <td>0.5</td>
    </tr>
    <tr>
      <th>300004</th>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

``` python
test.head().T
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>id</th>
      <th>300000</th>
      <th>300001</th>
      <th>300002</th>
      <th>300003</th>
      <th>300004</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bin_0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>bin_1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>bin_2</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>bin_3</th>
      <td>T</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
    </tr>
    <tr>
      <th>bin_4</th>
      <td>Y</td>
      <td>N</td>
      <td>Y</td>
      <td>Y</td>
      <td>N</td>
    </tr>
    <tr>
      <th>nom_0</th>
      <td>Blue</td>
      <td>Red</td>
      <td>Blue</td>
      <td>Red</td>
      <td>Red</td>
    </tr>
    <tr>
      <th>nom_1</th>
      <td>Triangle</td>
      <td>Square</td>
      <td>Square</td>
      <td>Star</td>
      <td>Trapezoid</td>
    </tr>
    <tr>
      <th>nom_2</th>
      <td>Axolotl</td>
      <td>Lion</td>
      <td>Dog</td>
      <td>Cat</td>
      <td>Dog</td>
    </tr>
    <tr>
      <th>nom_3</th>
      <td>Finland</td>
      <td>Canada</td>
      <td>China</td>
      <td>China</td>
      <td>China</td>
    </tr>
    <tr>
      <th>nom_4</th>
      <td>Piano</td>
      <td>Piano</td>
      <td>Piano</td>
      <td>Piano</td>
      <td>Piano</td>
    </tr>
    <tr>
      <th>nom_5</th>
      <td>0870b0a5d</td>
      <td>a5c276589</td>
      <td>568550f04</td>
      <td>c5725677e</td>
      <td>e70a6270d</td>
    </tr>
    <tr>
      <th>nom_6</th>
      <td>9ceb19dd6</td>
      <td>1ad744242</td>
      <td>1fe17a1fd</td>
      <td>a6542cec0</td>
      <td>97b6a3518</td>
    </tr>
    <tr>
      <th>nom_7</th>
      <td>530f8ecc3</td>
      <td>12e6161c9</td>
      <td>27d6df03f</td>
      <td>30c63bd0c</td>
      <td>a42386065</td>
    </tr>
    <tr>
      <th>nom_8</th>
      <td>9d117320c</td>
      <td>46ae3059c</td>
      <td>b759e21f0</td>
      <td>0b6ec68ff</td>
      <td>f91f3b1ee</td>
    </tr>
    <tr>
      <th>nom_9</th>
      <td>3c49b42b8</td>
      <td>285771075</td>
      <td>6f323c53f</td>
      <td>b5de3dcc4</td>
      <td>967cfa9c9</td>
    </tr>
    <tr>
      <th>ord_0</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>ord_1</th>
      <td>Novice</td>
      <td>Master</td>
      <td>Expert</td>
      <td>Contributor</td>
      <td>Grandmaster</td>
    </tr>
    <tr>
      <th>ord_2</th>
      <td>Warm</td>
      <td>Lava Hot</td>
      <td>Freezing</td>
      <td>Lava Hot</td>
      <td>Lava Hot</td>
    </tr>
    <tr>
      <th>ord_3</th>
      <td>j</td>
      <td>l</td>
      <td>a</td>
      <td>b</td>
      <td>l</td>
    </tr>
    <tr>
      <th>ord_4</th>
      <td>P</td>
      <td>A</td>
      <td>G</td>
      <td>Q</td>
      <td>W</td>
    </tr>
    <tr>
      <th>ord_5</th>
      <td>be</td>
      <td>RP</td>
      <td>tP</td>
      <td>ke</td>
      <td>qK</td>
    </tr>
    <tr>
      <th>day</th>
      <td>5</td>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>month</th>
      <td>11</td>
      <td>5</td>
      <td>12</td>
      <td>3</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>
<br/>

### 2.2 í”¼ì²˜ ìš”ì•½í‘œ ìƒì„±

í”¼ì²˜ ìš”ì•½í‘œëŠ” í”¼ì²˜ë³„ ë°ì´í„° íƒ€ì…, ê²°ì¸¡ê°’ ê°œìˆ˜, ê³ ìœ³ê°’ ê°œìˆ˜, ì‹¤ì œ ì…ë ¥ê°’ ë“±ì„ ì •ë¦¬í•œ í‘œì´ë‹¤.

<br/>

> í”¼ì²˜ ìš”ì•½í‘œë¥¼ ë§Œë“œëŠ” 3ë‹¨ê³„

**1. í”¼ì²˜ë³„ ë°ì´í„° íƒ€ì… DataFrame ìƒì„±***
   
**2. ì¸ë±ìŠ¤ ì¬ì„¤ì • í›„ ì—´ ì´ë¦„ ë³€ê²½**

**3. ê²°ì¸¡ê°’ ê°œìˆ˜, ê³ ìœ³ê°’ ê°œìˆ˜, 1~3í–‰ ì…ë ¥ê°’ ì¶”ê°€**

<br/>

#### 1. í”¼ì²˜ë³„ ë°ì´í„° íƒ€ì… DataFrame ìƒì„± 

DataFrame ê°ì²´ì—ì„œ dtypesë¥¼ í˜¸ì¶œí•˜ë©´ í”¼ì²˜ë³„ ë°ì´í„° íƒ€ì…ì„ ë°˜í™˜í•´ì¤€ë‹¤.

``` python
train.dtypes

'''
bin_0      int64
bin_1      int64
bin_2      int64
bin_3     object
bin_4     object
nom_0     object
nom_1     object
nom_2     object
nom_3     object
nom_4     object
nom_5     object
nom_6     object
nom_7     object
nom_8     object
nom_9     object
ord_0      int64
ord_1     object
ord_2     object
ord_3     object
ord_4     object
ord_5     object
day        int64
month      int64
target     int64
dtype: object
'''
```

<br/>
<br/>

ì´ ê°’ì„ ì…ë ¥ìœ¼ë¡œ DataFrameì„ ìƒˆë¡œ ìƒì„±í•˜ë©´ í”¼ì²˜ë³„ ë°ì´í„° íƒ€ì…ì´ ì…ë ¥ëœ DataFrameì´ ë§Œë“¤ì–´ì§„ë‹¤. ì´ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ columns íŒŒë¼ë¯¸í„°ë¡œ ì›í•˜ëŠ” ì—´ ì´ë¦„ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

``` python
summary = pd.DataFrame(train.dtypes, columns = ['ë°ì´í„° íƒ€ì…'])
summary.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ë°ì´í„° íƒ€ì…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bin_0</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>bin_1</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>bin_2</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>bin_3</th>
      <td>object</td>
    </tr>
    <tr>
      <th>bin_4</th>
      <td>object</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

#### 2. ì¸ë±ìŠ¤ ì¬ì„¤ì • í›„ ì—´ ì´ë¦„ ë³€ê²½

í˜„ì¬ í”¼ì²˜ ì´ë¦„ë“¤ì´ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©ì¤‘ì´ê¸° ë–„ë¬¸ì— í˜„ì¬ ì¸ë±ìŠ¤ë¥¼ ì—´ë¡œ ì˜®ê¸°ê³  ìƒˆë¡œìš´ ì¸ë±ìŠ¤ë¥¼ ë§Œë“ ë‹¤.

reset_index()ë¥¼ í˜¸ì¶œí•˜ë©´ í˜„ì¬ ì¸ë±ìŠ¤ë¥¼ ì—´ë¡œ ì˜®ê¸°ê³  ìƒˆë¡œìš´ ì¸ë±ìŠ¤ë¥¼ ë§Œë“ ë‹¤. ìƒˆë¡œìš´ ì¸ë±ìŠ¤ëŠ” 0ë¶€í„° ì‹œì‘í•´ 1ì”© ì¦ê°€í•˜ëŠ” ì •ìˆ˜ì´ë©°, ì˜®ê²¨ì§„ ì—´ì˜ ì´ë¦„ì€ 'index'ê°€ ëœë‹¤.

``` python
summary = summary.reset_index()

summary.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>ë°ì´í„° íƒ€ì…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bin_0</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bin_1</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bin_2</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bin_3</td>
      <td>object</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bin_4</td>
      <td>object</td>
    </tr>
  </tbody>
</table>
</div>


<br/>
<br/>

í˜„ì¬ í”¼ì²˜ ì´ë¦„ì´ í¬í•¨ëœ ì—´ ì´ë¦„ì´ index ì´ê¸° ë•Œë¬¸ì— rename()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì—´ ì´ë¦„ì„ 'í”¼ì²˜'ë¡œ ë°”ê¾¼ë‹¤.

``` python
summary = summary.rename(columns={'index':'í”¼ì²˜'})

summary.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>í”¼ì²˜</th>
      <th>ë°ì´í„° íƒ€ì…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bin_0</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bin_1</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bin_2</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bin_3</td>
      <td>object</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bin_4</td>
      <td>object</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

#### 3. ê²°ì¸¡ê°’ ê°œìˆ˜, ê³ ìœ ê°’ ê°œìˆ˜, 1~3í–‰ ì…ë ¥ê°’ ì¶”ê°€

DataFrameì— ê²°ì¸¡ê°’ ê°œìˆ˜, ê³ ìœ³ê°’ ê°œìˆ˜, ì²« ì„¸ ê°œ í–‰ì— ì…ë ¥ëœ ê°’ì„ ì¶”ê°€í•´ ë³´ì.

1. í”¼ì²˜ë³„ ê²°ì¸¡ê°’ ê°œìˆ˜ë¥¼ DataFrameì— ì¶”ê°€í•œë‹¤. isnull()ì€ ê²°ì¸¡ê°’ í¬í•¨ ì—¬ë¶€ë¥¼ True, Falseë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. TrueëŠ” 1, FalseëŠ” 0ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ isnull()ì„ ì ìš©í•œ DataFrameì— sum() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ Trueì˜ ê°œìˆ˜, ì¦‰ í”¼ì²˜ë³„ ê²°ì¸¡ê°’ ê°œìˆ˜ë¥¼ êµ¬í•´ì¤€ë‹¤.

2. í”¼ì²˜ë³„ ê³ ìœ ê°’ ê°œìˆ˜ë¥¼ ì¶”ê°€í•œë‹¤. nunique()ëŠ” í”¼ì²˜ë³„ ê³ ìœ³ê°’ ê°œìˆ˜ë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.  

3. í›ˆë ¨ ë°ì´í„° 1~3í–‰ì— ì…ë ¥ëœ ê°’ì„ ìš”ì•½í‘œ DataFrameì— ì¶”ê°€í•œë‹¤. ê° í”¼ì²˜ì— ì‹¤ì œ ì–´ë–¤ ê°’ë“¤ì´ ë“¤ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨ì´ë‹¤. loc[0]ì€ ì²« ë²ˆì§¸ í–‰, loc[1]ì€ ë‘ë²ˆì§¸ í–‰, loc[2]ëŠ” ì„¸ë²ˆì§¸ í–‰ì˜ ê°’ì„ ì˜ë¯¸í•œë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/3.jpeg" width="70%" height="70%"></p>

values ë¥¼ ì ìš©í•˜ì§€ ì•Šìœ¼ë©´ ë°˜í™˜ íƒ€ì…ì¸ SeriesëŠ” ì¸ë±ìŠ¤(bin_0, bin_1 ë“±)ê³¼ ê°’(0 ë“±)ì˜ ìŒìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ë”°ë¼ì„œ valuesë¥¼ í˜¸ì¶œí•´ ê°’ë§Œ ì¶”ì¶œí•˜ì—¬ summaryì— ì¶”ê°€í•œë‹¤.

<br/>

| `axis`Â ê°’ | ê¸°ì¤€ ë°©í–¥            | ì‘ë™ ë°©í–¥   | ì˜ë¯¸                  |
| -------- | ---------------- | ------- | ------------------- |
| `axis=0` | **í–‰(row)**Â ê¸°ì¤€    | ìœ„â†’ì•„ë˜ ë°©í–¥ | **ì—´(column) ë‹¨ìœ„ ê³„ì‚°** |
| `axis=1` | **ì—´(column)**Â ê¸°ì¤€ | ì™¼â†’ì˜¤ ë°©í–¥  | **í–‰(row) ë‹¨ìœ„ ê³„ì‚°**    |


``` python
# 1. í”¼ì²˜ë³„ ê²°ì¸¡ê°’ ê°œìˆ˜
summary['ê²°ì¸¡ê°’ ê°œìˆ˜'] = train.isnull().sum().values
'''
- isnull()Â âÂ ì›ì†Œ ë‹¨ìœ„ë¡œ ì‘ë™í•´ì„œÂ True / FalseÂ ê°’ì„ ê°€ì§„Â ë™ì¼ í¬ê¸°ì˜ DataFrameì„ ë°˜í™˜
- sum()Â â ê¸°ë³¸ì ìœ¼ë¡œ ì—´ ë‹¨ìœ„(axis=0)ë¡œ ì‘ë™í•´ì„œÂ ê° ì—´ì˜ ê²°ì¸¡ê°’ ê°œìˆ˜ë¥¼ ë°˜í™˜
'''

# 2. í”¼ì²˜ë³„ ê³ ìœ³ê°’ ê°œìˆ˜
summary['ê³ ìœ³ê°’ ê°œìˆ˜'] = train.nunique().values
'''
nunique()ëŠ”Â ê¸°ë³¸ì ìœ¼ë¡œ ì—´(axis=0) ë‹¨ìœ„ë¡œ ì‘ë™
'''
# 3. 1~3í–‰ì— ì…ë ¥ë˜ì–´ ìˆëŠ” ê°’
summary['ì²« ë²ˆì§¸ ê°’'] = train.loc[0].values
summary['ë‘ ë²ˆì§¸ ê°’'] = train.loc[1].values
summary['ì„¸ ë²ˆì§¸ ê°’'] = train.loc[1].values

summary.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>í”¼ì²˜</th>
      <th>ë°ì´í„° íƒ€ì…</th>
      <th>ê²°ì¸¡ê°’ ê°œìˆ˜</th>
      <th>ê³ ìœ³ê°’ ê°œìˆ˜</th>
      <th>ì²« ë²ˆì§¸ ê°’</th>
      <th>ë‘ ë²ˆì§¸ ê°’</th>
      <th>ì„¸ ë²ˆì§¸ ê°’</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bin_0</td>
      <td>int64</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bin_1</td>
      <td>int64</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bin_2</td>
      <td>int64</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bin_3</td>
      <td>object</td>
      <td>0</td>
      <td>2</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bin_4</td>
      <td>object</td>
      <td>0</td>
      <td>2</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

#### 4. í”¼ì²˜ ìš”ì•½í‘œ ìƒì„±í•¨ìˆ˜ 

``` python
def resumetable(df):
    print(f'ë°ì´í„°ì…‹ í˜•ìƒ: {df.shape}')

    # ìŠ¤í… 1: í”¼ì²˜ë³„ ë°ì´í„° íƒ€ì… DataFrame ìƒì„±
    summary = pd.DataFrame(df.dtypes, columns=['ë°ì´í„° íƒ€ì…'])
    
    # ìŠ¤í… 2: ì¸ë±ìŠ¤ ì¬ì„¤ì • í›„ ì—´ ì´ë¦„ ë³€ê²½
    # 2-1: ì¸ë±ìŠ¤ ì¬ì„¤ì •
    summary = summary.reset_index()
    # 2-2: ì—´ ì´ë¦„ ë³€ê²½
    summary = summary.rename(columns={'index': 'í”¼ì²˜'})
    
    # ìŠ¤í… 3: ê²°ì¸¡ê°’ ê°œìˆ˜, ê³ ìœ³ê°’ ê°œìˆ˜, 1~3í–‰ ì…ë ¥ê°’ ì¶”ê°€
    # í”¼ì²˜ë³„ ê²°ì¸¡ê°’ ê°œìˆ˜
    summary['ê²°ì¸¡ê°’ ê°œìˆ˜'] = df.isnull().sum().values    
    # í”¼ì²˜ë³„ ê³ ìœ³ê°’ ê°œìˆ˜
    summary['ê³ ìœ³ê°’ ê°œìˆ˜'] = df.nunique().values
    # 1~3í–‰ì— ì…ë ¥ë˜ì–´ ìˆëŠ” ê°’
    summary['ì²« ë²ˆì§¸ ê°’'] = df.loc[0].values
    summary['ë‘ ë²ˆì§¸ ê°’'] = df.loc[1].values
    summary['ì„¸ ë²ˆì§¸ ê°’'] = df.loc[2].values

    return summary

resumetable(train)
```

ë°ì´í„°ì…‹ í˜•ìƒ: (300000, 24)

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>í”¼ì²˜</th>
      <th>ë°ì´í„° íƒ€ì…</th>
      <th>ê²°ì¸¡ê°’ ê°œìˆ˜</th>
      <th>ê³ ìœ³ê°’ ê°œìˆ˜</th>
      <th>ì²« ë²ˆì§¸ ê°’</th>
      <th>ë‘ ë²ˆì§¸ ê°’</th>
      <th>ì„¸ ë²ˆì§¸ ê°’</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bin_0</td>
      <td>int64</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bin_1</td>
      <td>int64</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bin_2</td>
      <td>int64</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bin_3</td>
      <td>object</td>
      <td>0</td>
      <td>2</td>
      <td>T</td>
      <td>T</td>
      <td>F</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bin_4</td>
      <td>object</td>
      <td>0</td>
      <td>2</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>5</th>
      <td>nom_0</td>
      <td>object</td>
      <td>0</td>
      <td>3</td>
      <td>Green</td>
      <td>Green</td>
      <td>Blue</td>
    </tr>
    <tr>
      <th>6</th>
      <td>nom_1</td>
      <td>object</td>
      <td>0</td>
      <td>6</td>
      <td>Triangle</td>
      <td>Trapezoid</td>
      <td>Trapezoid</td>
    </tr>
    <tr>
      <th>7</th>
      <td>nom_2</td>
      <td>object</td>
      <td>0</td>
      <td>6</td>
      <td>Snake</td>
      <td>Hamster</td>
      <td>Lion</td>
    </tr>
    <tr>
      <th>8</th>
      <td>nom_3</td>
      <td>object</td>
      <td>0</td>
      <td>6</td>
      <td>Finland</td>
      <td>Russia</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>9</th>
      <td>nom_4</td>
      <td>object</td>
      <td>0</td>
      <td>4</td>
      <td>Bassoon</td>
      <td>Piano</td>
      <td>Theremin</td>
    </tr>
    <tr>
      <th>10</th>
      <td>nom_5</td>
      <td>object</td>
      <td>0</td>
      <td>222</td>
      <td>50f116bcf</td>
      <td>b3b4d25d0</td>
      <td>3263bdce5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>nom_6</td>
      <td>object</td>
      <td>0</td>
      <td>522</td>
      <td>3ac1b8814</td>
      <td>fbcb50fc1</td>
      <td>0922e3cb8</td>
    </tr>
    <tr>
      <th>12</th>
      <td>nom_7</td>
      <td>object</td>
      <td>0</td>
      <td>1220</td>
      <td>68f6ad3e9</td>
      <td>3b6dd5612</td>
      <td>a6a36f527</td>
    </tr>
    <tr>
      <th>13</th>
      <td>nom_8</td>
      <td>object</td>
      <td>0</td>
      <td>2215</td>
      <td>c389000ab</td>
      <td>4cd920251</td>
      <td>de9c9f684</td>
    </tr>
    <tr>
      <th>14</th>
      <td>nom_9</td>
      <td>object</td>
      <td>0</td>
      <td>11981</td>
      <td>2f4cb3d51</td>
      <td>f83c56c21</td>
      <td>ae6800dd0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ord_0</td>
      <td>int64</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ord_1</td>
      <td>object</td>
      <td>0</td>
      <td>5</td>
      <td>Grandmaster</td>
      <td>Grandmaster</td>
      <td>Expert</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ord_2</td>
      <td>object</td>
      <td>0</td>
      <td>6</td>
      <td>Cold</td>
      <td>Hot</td>
      <td>Lava Hot</td>
    </tr>
    <tr>
      <th>18</th>
      <td>ord_3</td>
      <td>object</td>
      <td>0</td>
      <td>15</td>
      <td>h</td>
      <td>a</td>
      <td>h</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ord_4</td>
      <td>object</td>
      <td>0</td>
      <td>26</td>
      <td>D</td>
      <td>A</td>
      <td>R</td>
    </tr>
    <tr>
      <th>20</th>
      <td>ord_5</td>
      <td>object</td>
      <td>0</td>
      <td>192</td>
      <td>kr</td>
      <td>bF</td>
      <td>Jc</td>
    </tr>
    <tr>
      <th>21</th>
      <td>day</td>
      <td>int64</td>
      <td>0</td>
      <td>7</td>
      <td>2</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>22</th>
      <td>month</td>
      <td>int64</td>
      <td>0</td>
      <td>12</td>
      <td>2</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>target</td>
      <td>int64</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>
<br/>

### 2.3 í”¼ì²˜ ìš”ì•½í‘œ í•´ì„

1. **ì´ì§„(binary) í”¼ì²˜: bin_0 ~ bin_4**

2. **ëª…ëª©í˜•(nominal) í”¼ì²˜: nom_0 ~ nom_9**

3. **ìˆœì„œí˜•(ordinal) í”¼ì²˜: ord_0 ~ ord_5**

4. **ê·¸ ì™¸ í”¼ì²˜: day, month, target**

<br/>

#### 1. ì´ì§„(binary) í”¼ì²˜: bin_0 ~ bin_4

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/4.jpeg" width="70%" height="70%"></p>

- ì´ì§„ í”¼ì²˜ë“¤ì€ ê³ ìœ³ê°’ì´ ëª¨ë‘ 2ê°œì´ë‹¤. ì´ì¤‘ bin_0, bin_1, bin_2 ëŠ” ë°ì´í„° íƒ€ì…ì´ int64ê³ , ì‹¤ì ¯ê°’ì´ 0 ë˜ëŠ” 1ë¡œ êµ¬ì„±ë¼ ìˆë‹¤.
  
- bin_3, bin_4ëŠ” object íƒ€ì…ì´ê³ , ì‹¤ì ¯ê°’ì€ T ë˜ëŠ” F(bin_3 í”¼ì²˜), Y ë˜ëŠ” N(bin_4 í”¼ì²˜) ì´ë‹¤.
  
- ë”°ë¼ì„œ Tì™€ YëŠ” 1ë¡œ, Fì™€ Nì€ 0ìœ¼ë¡œ ì¸ì½”ë”© í•œë‹¤.

<br/>

#### 2. ëª…ëª©í˜•(nominal) í”¼ì²˜: nom_0 ~ nom_9

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/5.jpeg" width="70%" height="70%"></p>

- ëª…ëª©í˜• í”¼ì²˜ëŠ” ëª¨ë‘ object íƒ€ì…ì´ê³  ê²°ì¸¡ê°’ì€ ì—†ë‹¤. nom_0 ë¶€í„° nom_4ëŠ” ê³ ìœ³ê°’ì´ 6ê°œ ì´í•˜ì¸ë°, nom_5 ë¶€í„° nom_9ëŠ” ê³ ìœ³ê°’ì´ ë§ìœ¼ë©° ì˜ë¯¸ë¥¼ ì•Œ ìˆ˜ ì—†ëŠ” ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br/>

#### 3. ìˆœì„œí˜•(ordinal) í”¼ì²˜: ord_0 ~ ord_5

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/6.jpeg" width="70%" height="70%"></p>

- ord_0 í”¼ì²˜ë§Œ int64 íƒ€ì…ì´ê³  ë‚˜ë¨¸ì§€ëŠ” object íƒ€ì…ë‹ˆë‹¤. ëª…ëª©í˜• ë°ì´í„°ì™€ ë‹¤ë¥´ê²Œ ìˆœì„œí˜• ë°ì´í„°ëŠ” ìˆœì„œê°€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.

- ìˆœì„œì— ë”°ë¼ íƒ€ê²Ÿê°’ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ìˆœì„œì— ìœ ì˜í•˜ì—¬ ì¸ì½”ë”© í•´ì•¼í•œë‹¤.


<br/>
<br/>

#### ord_0, ord_1, ord_2 feature ê³ ìœ³ê°’ í™•ì¸

unique()í•¨ìˆ˜ë¥¼ í†µí•´ ê³ ìœ³ê°’ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.

``` python
for i in range(3):
	feature = 'ord_' + str(i)
	print(f'{feature} ê³ ìœ³ê°’: {train[feature].unique()}')

''' 
ord_0 ê³ ìœ³ê°’: [2 1 3]
ord_1 ê³ ìœ³ê°’: ['Grandmaster' 'Expert' 'Novice' 'Contributor' 'Master']
ord_2 ê³ ìœ³ê°’: ['Cold' 'Hot' 'Lava Hot' 'Boiling Hot' 'Freezing' 'Warm']
'''
```

- unique() í•¨ìˆ˜ëŠ” ê³ ìœ³ê°’ì´ ë“±ì¥í•œ ìˆœìœ¼ë¡œ ì¶œë ¥í•œë‹¤. ord_0 í”¼ì²˜ì˜ ê³ ìœ³ê°’ì€ ìˆ«ì í¬ê¸°ì— ìˆœì„œë¥¼ ë§ì¶”ë©´ ë˜ê³  ord_1 í”¼ì²˜ì˜ ê³ ìœ³ê°’ì€ ë“±ê¸‰ì— ë”°ë¼ Novice, Contributor, Expert, Master, Grandmaster ìˆœìœ¼ë¡œ ë§ì¶˜ë‹¤.

- ord_2 í”¼ì²˜ëŠ” ì¶¥ê³  ë”ì›€ ì •ë„ë¥¼ ë‚˜íƒ€ë‚´ë¯€ë¡œ Freezing, Cold, Warm, Hot, Boiling Hot, Lava Hot ìˆœìœ¼ë¡œ ë§ì¶˜ë‹¤.

> ë¯¸ë¦¬ ì •ë¦¬í•´ë†”ì•¼ ì¸ì½”ë”©í•  ë•Œ ìˆœì„œì— ë§ê²Œ ë§¤í•‘í•˜ê¸° í¸í•˜ë‹¤.

<br/>
<br/>


#### ê³ ìœ³ê°’ ê°œìˆ˜ê°€ ë§ì€ ord_3, ord_4, ord_5 feature ê³ ìœ³ê°’ í™•ì¸

``` python
for i in range(3, 6):
	feature = 'ord_' + str(i)
	print(f'{feature} ê³ ìœ³ê°’ : {train[feature].unique()}', end='\n\n')

'''
ord_3 ê³ ìœ³ê°’ : ['h' 'a' 'i' 'j' 'g' 'e' 'd' 'b' 'k' 'f' 'l' 'n' 'o' 'c' 'm']

ord_4 ê³ ìœ³ê°’ : ['D' 'A' 'R' 'E' 'P' 'K' 'V' 'Q' 'Z' 'L' 'F' 'T' 'U' 'S' 'Y' 'B' 'H' 'J'
 'N' 'G' 'W' 'I' 'O' 'C' 'X' 'M']

ord_5 ê³ ìœ³ê°’ : ['kr' 'bF' 'Jc' 'kW' 'qP' 'PZ' 'wy' 'Ed' 'qo' 'CZ' 'qX' 'su' 'dP' 'aP'
 'MV' 'oC' 'RL' 'fh' 'gJ' 'Hj' 'TR' 'CL' 'Sc' 'eQ' 'kC' 'qK' 'dh' 'gM'
 'Jf' 'fO' 'Eg' 'KZ' 'Vx' 'Fo' 'sV' 'eb' 'YC' 'RG' 'Ye' 'qA' 'lL' 'Qh'
 'Bd' 'be' 'hT' 'lF' 'nX' 'kK' 'av' 'uS' 'Jt' 'PA' 'Er' 'Qb' 'od' 'ut'
 'Dx' 'Xi' 'on' 'Dc' 'sD' 'rZ' 'Uu' 'sn' 'yc' 'Gb' 'Kq' 'dQ' 'hp' 'kL'
 'je' 'CU' 'Fd' 'PQ' 'Bn' 'ex' 'hh' 'ac' 'rp' 'dE' 'oG' 'oK' 'cp' 'mm'
 'vK' 'ek' 'dO' 'XI' 'CM' 'Vf' 'aO' 'qv' 'jp' 'Zq' 'Qo' 'DN' 'TZ' 'ke'
 'cG' 'tP' 'ud' 'tv' 'aM' 'xy' 'lx' 'To' 'uy' 'ZS' 'vy' 'ZR' 'AP' 'GJ'
 'Wv' 'ri' 'qw' 'Xh' 'FI' 'nh' 'KR' 'dB' 'BE' 'Bb' 'mc' 'MC' 'tM' 'NV'
 'ih' 'IK' 'Ob' 'RP' 'dN' 'us' 'dZ' 'yN' 'Nf' 'QM' 'jV' 'sY' 'wu' 'SB'
 'UO' 'Mx' 'JX' 'Ry' 'Uk' 'uJ' 'LE' 'ps' 'kE' 'MO' 'kw' 'yY' 'zU' 'bJ'
 'Kf' 'ck' 'mb' 'Os' 'Ps' 'Ml' 'Ai' 'Wc' 'GD' 'll' 'aF' 'iT' 'cA' 'WE'
 'Gx' 'Nk' 'OR' 'Rm' 'BA' 'eG' 'cW' 'jS' 'DH' 'hL' 'Mf' 'Yb' 'Aj' 'oH'
 'Zc' 'qJ' 'eg' 'xP' 'vq' 'Id' 'pa' 'ux' 'kU' 'Cl']
'''
```

> ord_3, ord_4, ord_5 í”¼ì²˜ëŠ” ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì •ë ¬ë˜ì–´ ìˆë‹¤. ì´ í”¼ì²˜ë“¤ì€ ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì¸ì½”ë”© í•œë‹¤.

<br/>
<br/>

#### ê·¸ ì™¸ features: day, month, target

``` python
print('day ê³ ìœ³ê°’: ', train['day'].unique())
print('month ê³ ìœ³ê°’: ', train['month'].unique())
print('target ê³ ìœ³ê°’: ', train['target'].unique())

'''
day ê³ ìœ³ê°’:  [2 7 5 4 3 1 6]
month ê³ ìœ³ê°’:  [ 2  8  1  4 10  3  7  9 12 11  5  6]
target ê³ ìœ³ê°’:  [0 1]
'''
```

- day í”¼ì²˜ì˜ ê³ ìœ³ê°’ì´ 7ê°œ ì´ë‹¤. ìš”ì¼ì„ ë‚˜íƒ€ë‚¸ë‹¤ê³  ì§ì‘í•  ìˆ˜ ìˆë‹¤.

- month í”¼ì²˜ì˜ ê³ ìœ³ê°’ì€ 1ë¶€í„° 12ì´ë‹¤. ì›”ì„ ë‚˜íƒ€ë‚¸ë‹¤.

- íƒ€ê²Ÿê°’ì€ 0 ë˜ëŠ” 1ë¡œ êµ¬ì„±ë¼ ìˆë‹¤.

<br/>
<br/>
<br/>

## 3. ë°ì´í„° ì‹œê°í™”

#### ì‹œê°í™” ë¼ì´ë¸ŒëŸ¬ë¦¬ import 
``` python
import seaborn as sns
import matplotlib as mpl
import matplotlib.pyplot as plt
```

<br/>

### 3.1 íƒ€ê²Ÿê°’ ë¶„í¬ í™•ì¸


| í”Œë¡¯ ì¢…ë¥˜        | x í•„ìš” | y í•„ìš” | ë°ì´í„° ê°œìˆ˜ | ì£¼ìš” ëª©ì                                |
| ------------ | ---- | ---- | ------ | ----------------------------------- |
| `barplot`    | âœ… ìˆìŒ | âœ… ìˆìŒ | 2ê°œ í•„ìš”  | ì¹´í…Œê³ ë¦¬ë³„ í†µê³„ëŸ‰(**í‰ê· **) ì‹œê°í™”               |
| `countplot`  | âœ… ìˆìŒ | âŒ ì—†ìŒ | 1ê°œë©´ ë¨  | ì¹´í…Œê³ ë¦¬ë³„ **ë¹ˆë„ìˆ˜** ì‹œê°í™”                   |
| `histplot`   | âœ… ìˆìŒ | âŒ ì—†ìŒ | 1ê°œë©´ ë¨  | ì—°ì†í˜• ìˆ˜ì¹˜ì˜ **ë¶„í¬** ì‹œê°í™” (íˆìŠ¤í† ê·¸ë¨)          |
| `displot`    | âœ… ìˆìŒ | âŒ ì—†ìŒ | 1ê°œë©´ ë¨  | ì¡°ê±´ë³„ ë¶„í¬(íˆìŠ¤í† ê·¸ë¨ or KDE) ì‹œê°í™” (Facet ê°€ëŠ¥) |
| `kdeplot`    | âœ… ìˆìŒ | âŒ ì—†ìŒ | 1ê°œë©´ ë¨  | ë°ì´í„°ì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜ ê³¡ì„ (KDE) ì‹œê°í™”           |
| `boxplot`    | âœ… ìˆìŒ | âœ… ìˆìŒ | 2ê°œ í•„ìš”  | ì‚¬ë¶„ìœ„/ì¤‘ì•™ê°’/ì´ìƒì¹˜ ì‹œê°í™” (í†µê³„ ìš”ì•½)             |
| `violinplot` | âœ… ìˆìŒ | âœ… ìˆìŒ | 2ê°œ í•„ìš”  | boxplot + KDE â†’ ë¶„í¬ì™€ ìš”ì•½ì„ ë™ì‹œì— í‘œí˜„      |
| `stripplot`  | âœ… ìˆìŒ | âœ… ìˆìŒ | 2ê°œ í•„ìš”  | ë°ì´í„°ì˜ ê°œë³„ í¬ì¸íŠ¸ ë¶„í¬ë¥¼ ì ìœ¼ë¡œ í‘œì‹œ              |
| `swarmplot`  | âœ… ìˆìŒ | âœ… ìˆìŒ | 2ê°œ í•„ìš”  | stripplotì˜ ì ì´ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ìë™ ë°°ì¹˜         |


##### ğŸ“Š barplot

```python
sns.barplot(x="ê³¼ëª©", y="ì ìˆ˜", data=df) # ê³¼ëª©ë³„ í‰ê·  ì ìˆ˜
```

##### ğŸ“ˆ countplot

```python
sns.countplot(x="ì„±ë³„", data=df) # â†’ ë‚¨ì/ì—¬ì ê°ê° ëª‡ ëª…ì¸ì§€
```

##### ğŸ“‰ histplot

```python
sns.histplot(x="ì—°ë´‰", data=df, bins=30) # â†’ ì—°ë´‰ì´ 1000~~2000, 2000~~3000 ì´ëŸ° ì‹ìœ¼ë¡œ êµ¬ê°„ë³„ë¡œ ëª‡ ëª… ìˆëŠ”ì§€
```

<br/>
<br/>

---

- íƒ€ê²Ÿê°’ ë¶„í¬ë¥¼ ì•Œë©´ ë°ì´í„°ê°€ ì–¼ë§ˆë‚˜ ë¶ˆê· í˜•í•œì§€ íŒŒì•…í•˜ê¸° ì‰½ë‹¤.
  
- ì´ë¥¼ ìœ„í•´ ì¹´ìš´íŠ¸í”Œë¡¯ìœ¼ë¡œ íƒ€ê²Ÿê°’ 0ê³¼ 1ì˜ ê°œìˆ˜ë¥¼ íŒŒì•…í•œë‹¤.
  
- ì¹´ìš´íŠ¸í”Œë¡¯ì€ ë²”ì£¼í˜• ë°ì´í„° ê°œìˆ˜ë¥¼ í™•ì¸í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤. (ë³´í†µì€ ì–‘ì„±(íƒ€ê²Ÿê°’ 1)ì´ ìŒì„±(íƒ€ê²Ÿê°’ 0)ì— ë¹„í•´ ê°œìˆ˜ê°€ ì ë‹¤.)

<br/>

> ìˆ˜ì¹˜í˜• ë°ì´í„°ì˜ ë¶„í¬ë¥¼ íŒŒì•…í•  ë• ì£¼ë¡œ displot()ì„ ì‚¬ìš©í•˜ê³ , ë²”ì£¼í˜• ë°ì´í„°ì˜ ë¶„í¬ë¥¼ íŒŒì•…í•  ë• countplot()ì„ ì‚¬ìš©.

``` python
mpl.rc('font', size=15)
plt.figure(figsize=(7, 6))

# íƒ€ê²Ÿê°’ ë¶„í¬ ì¹´ìš´íŠ¸í”Œë¡¯
ax = sns.countplot(x='target', data=train)
ax.set_title('Target Distribution')
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/7.png" width="60%" height="60%"></p>

<br/>
<br/>

#### ê° ê°’ì˜ ë¹„ìœ¨ì„ ê·¸ë˜í”„ ìƒë‹¨ì— í‘œì‹œ 

**ax.patches**

> ax.patches ëŠ” 'ax ì¶•ì„ êµ¬ì„±í•˜ëŠ” ê·¸ë˜í”„ ë„í˜• ê°ì²´ ëª¨ë‘ë¥¼ ë‹´ì€ ë¦¬ìŠ¤íŠ¸' ì´ë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/8.jpeg" width="50%" height="50%"></p>

> countplot()ì—ì„œ ë§‰ëŒ€ ë„í˜•ì˜ ë†’ì´ëŠ” ë°ì´í„° ê°œìˆ˜ì™€ ê°™ë‹¤.

``` python
rectangle = ax.patches[0] # ì²« ë²ˆì§¸ Rectangle ê°ì²´

print('ì‚¬ê°í˜• ë†’ì´: ', rectangle.get_height())
print('ì‚¬ê°í˜• ë„ˆë¹„: ', rectangle.get_width())
print('ì‚¬ê°í˜• ì™¼ìª½ í…Œë‘ë¦¬ì˜ xì¶• ìœ„ì¹˜: ', rectangle.get_x())

print('í…ìŠ¤íŠ¸ ìœ„ì¹˜ì˜ xì¢Œí‘œ: ', rectangle.get_x() + rectangle.get_width() / 2.0)
print('í…ìŠ¤íŠ¸ ìœ„ì¹˜ì˜ yì¢Œí‘œ: ', rectangle.get_height() + len(train) * 0.001)

''' ì¶œë ¥
ì‚¬ê°í˜• ë†’ì´:  208236.0
ì‚¬ê°í˜• ë„ˆë¹„:  0.8
ì‚¬ê°í˜• ì™¼ìª½ í…Œë‘ë¦¬ì˜ xì¶• ìœ„ì¹˜:  -0.4
í…ìŠ¤íŠ¸ ìœ„ì¹˜ì˜ xì¢Œí‘œ:  0.0
í…ìŠ¤íŠ¸ ìœ„ì¹˜ì˜ yì¢Œí‘œ:  208536.0
'''
```

<br/>

#### ë¹„ìœ¨ì„ í¬ì‹œí—¤ì£¼ëŠ” ì½”ë“œë¥¼ í•¨ìˆ˜ë¡œ êµ¬í˜„í•œ í›„, í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì¹´ìš´íŠ¸í”Œë¡¯ ìƒì„±

``` python
def write_percent(ax, total_size):
    '''ë„í˜• ê°ì²´ë¥¼ ìˆœíšŒí•˜ë©° ë§‰ëŒ€ ìƒë‹¨ì— íƒ€ê²Ÿê°’ ë¹„ìœ¨ í‘œì‹œ'''
    for patch in ax.patches:
    
    if patch.get_height() == 0:
			continue

        height = patch.get_height()
        width = patch.get_width()
        left_coord = patch.get_x()          # ë„í˜• ì™¼ìª½ í…Œë‘ë¦¬ì˜ xì¶• ìœ„ì¹˜
        percent = height / total_size * 100 # target ê°’ ë¹„ìœ¨
        ax.text(x = left_coord + width / 2.0,    # xì¶• ìœ„ì¹˜
                y = height + total_size * 0.001, # yì¶• ìœ„ì¹˜ (ìƒê°ë³´ë‹¤ ë§ì´ ì»¤ì•¼í•´ì„œ total_sizeì—ì„œ ì„ì˜ë¡œ ê³±í•˜ëŠ”ê²ƒ)
                s = f'{percent:1.1f}%',          # ì…ë ¥ í…ìŠ¤íŠ¸ (s: string)
                ha = 'center')                   # ê°€ìš´ë° ì •ë ¬ (ha : horizontal alignment)

plt.figure(figsize=(7, 6))
ax = sns.countplot(x='target', data=train)
write_percent(ax, len(train)) # ë¹„ìœ¨ í‘œì‹œ
ax.set_title('Target Disitribution')
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/9.png" width="60%" height="60%"></p>


<br/>
<br/>
<br/>


### 3.2 ì´ì§„ í”¼ì²˜ ë¶„í¬

ê³ ìœ³ê°’ì´ Yesì™€ Noì¼ ë•Œ
Yesì¸ ë°ì´í„° ì¤‘ì—ì„œ íƒ€ê²Ÿê°’ì´ 0ì¸ ë°ì´í„°ì™€ 1ì¸ ë°ì´í„°ì˜ ë¶„í¬(ë¹„ìœ¨)ì„ ë‚˜ëˆ ê·¸ë¦¬ê³ , 
Noì¸ ë°ì´í„° ì¤‘ì—ì„œë„ íƒ€ê²Ÿê°’ì´ 0ì¸ ë¹„ìœ¨ê³¼ 1ì¸ ë¹„ìœ¨ì„ ë”°ë¡œ ê·¸ë ¤ë³´ë©´, íŠ¹ì • ê³ ìœ³ê°’ì´ íŠ¹ì • íƒ€ê²Ÿê°’ì— ì¹˜ìš°ì¹˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> ë²”ì£¼í˜• í”¼ì²˜ì˜ íƒ€ê²Ÿê°’ ë¶„í¬ë¥¼ ê³ ìœ³ê°’ë³„ë¡œ êµ¬ë¶„í•´ ê·¸ë ¤ë³´ë©´ íŠ¹ì • ê³ ìœ³ê°’ì´ íŠ¹ì • íƒ€ê²Ÿê°’ì— ì¹˜ìš°ì¹˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/10.jpeg" width="60%" height="60%"></p>

``` python
import matplotlib.gridspec as gridspec # ì—¬ëŸ¬ ê·¸ë˜í”„ë¥¼ ê²©ì í˜•íƒœë¡œ ë°°ì¹˜ 

# 3í–‰ 2ì—´ í‹€(Figure) ì¤€ë¹„ 
mpl.rc('font', size=12)
grid = gridspec.GridSpec(3, 2) # ê·¸ë˜í”„(ì„œë¸Œí”Œë¡¯)ë¥¼ 3í–‰ 2ì—´ë¡œ ë°°ì¹˜ 
'''
ì„œë¸Œí”Œë¡¯ì„ 3í–‰ 2ì—´ë¡œ ë°°ì¹˜í•œ GridSpec ê°ì²´ë¥¼ grid ë³€ìˆ˜ì— í• ë‹¹í•œë‹¤.
ì¶”í›„ grid[0], grid[1], ... ì‹ìœ¼ë¡œ ì›í•˜ëŠ” ì„œë¸Œí”Œë¡¯ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. 
ì´ì§„ í”¼ì²˜ëŠ” ì´ 5ê°œì´ë¯€ë¡œ ë§ˆì§€ë§‰ ì„œë¸Œí”Œë¡¯ì—ëŠ” ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ì§€ ì•ŠëŠ”ë‹¤.
'''

plt.figure(figsize=(10, 16))  # ì „ì²´ Figure í¬ê¸° ì„¤ì • 
plt.subplots_adjust(wspace=0.4, hspace=0.3) # ì„œë¸Œí”Œë¡¯ ê°„ ì¢Œìš°/ìƒí•˜ ì—¬ë°± ì„¤ì •
'''
ì„œë¸Œí”Œë¡¯ ì‚¬ì´ì˜ ì—¬ë°±ì„ ì¡°ì •í•œë‹¤. ì•ì—ì„œëŠ” tight_layout()ì„ ì´ìš©í•´ ì—¬ë°±ì„ ìë™ìœ¼ë¡œ ì¡°ì •í–ˆì§€ë§Œ,
subplots_adjust()ë¥¼ í™œìš©í•˜ë©´ ì¢Œìš°, ìƒí•˜ ê°„ê²©ì„ ë”°ë¡œ ì¡°ì •í•  ìˆ˜ ìˆë‹¤.
wspace=0.4ëŠ” ì¢Œìš° ì—¬ë°±ì„ ì¶• ë„ˆë¹„ì˜ 40%ë¡œ, hspace=0.3ì€ ìƒí•˜ ì—¬ë°±ì„ ì¶• ë†’ì´ì˜ 30%ë¡œ ì„¤ì •í•œë‹¤.
'''

# ì„œë¸Œí”Œë¡¯ ê·¸ë¦¬ê¸° 
bin_featuers = ['bin_0', 'bin_1', 'bin_2', 'bin_3', 'bin_4'] # í”¼ì²˜ ëª©ë¡ 
'''
ì´ì§„ í”¼ì²˜ì˜ ëª©ë¡ì„ bin_featuresì— ë‹´ì€ í›„ forë¬¸ì„ í™œìš©í•´ ê°ê°ì˜ ì¹´ìš´íŠ¸í”Œë¡¯ì„ ê·¸ë¦°ë‹¤.
ì¹´ìš´íŠ¸í”Œë¡¯ì„ ê·¸ë¦¬ëŠ” ì ˆì°¨ëŠ” bin_featureë¥¼ ìˆœíšŒí•˜ë©° ê²©ì(grid)ì—ì„œ ì´ë²ˆ ì„œë¸Œí”Œë¡¯ì„ ê·¸ë¦´ ìœ„ì¹˜ë¥¼ axì¶•ìœ¼ë¡œ ì§€ì •í•˜ê³  
axì¶•ì— íƒ€ê²Ÿê°’ ë¶„í¬ ì¹´ìš´íŠ¸í”Œë¡¯ì„ ê·¸ë¦° ë‹¤ìŒ ì œëª©ì„ ë‹¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ ë¹„ìœ¨ë¡œ í‘œì‹œí•œë‹¤.
'''

for idx, feature in enumerate(bin_featuers):
    ax = plt.subplot(grid[idx])

    # axì¶•ì— íƒ€ê²Ÿê°’ ë¶™í¬ ì¹´ìš´íŠ¸í”Œë¡¯ ê·¸ë¦¬ê¸° 
    sns.countplot(x = feature,
                  data = train,
                  hue = 'target',
                  # `hue`ëŠ” ìƒ‰ê¹”ì„ í†µí•´ "ë˜ ë‹¤ë¥¸ ë²”ì£¼(feature)"ë¥¼ ì‹œê°ì ìœ¼ë¡œ êµ¬ë¶„í•˜ëŠ” ì—­í• 
                  # `hue='target'`Â â†’ featureê°€ ê°™ë”ë¼ë„, target ê°’(ì˜ˆ: 0 vs 1)ìœ¼ë¡œÂ ì„œë¸Œ ì¹´í…Œê³ ë¦¬ë¥¼ ë‚˜ëˆ”
                  palette = 'pastel', # ê·¸ë˜í”„ ìƒ‰ìƒ ì„¤ì •
                  ax = ax)
    '''
    hue: ì„¸ë¶€ì ìœ¼ë¡œ ë‚˜ëˆ  ê·¸ë¦´ ê¸°ì¤€ í”¼ì²˜. ì—¬ê¸°ì„œëŠ” íƒ€ê²Ÿê°’ì„ ì „ë‹¬.
    palette: ê·¸ë˜í”„ ìƒ‰ìƒë§µ. 'pastel'ì„ ì „ë‹¬í•˜ë©´ íŒŒìŠ¤í…”í†¤ìœ¼ë¡œ ê·¸ë˜í”„ ê·¸ë¦¼.
    ax: ê·¸ë˜í”„ë¥¼ ê·¸ë¦´ ì¶•
    '''
    
    ax.set_title(f'{feature} Distribution by Target') # ê·¸ë˜í”„ ì œëª© ì„¤ì • 
    write_percent(ax, len(train)) # ë¹„ìœ¨ í‘œì‹œ
```

|ì†ì„±|ì—­í• |
|---|---|
|`x`Â orÂ `y`|ë©”ì¸ ê¸°ì¤€ (xì¶• ë˜ëŠ” yì¶•ì˜ ë²”ì£¼ê°’)|
|`hue`|**ì„¸ë¶€ ê·¸ë£¹ì„ ë‚˜ëˆ„ëŠ” ì¶”ê°€ ê¸°ì¤€**|
|`palette`|hueë¡œ êµ¬ë¶„ëœ ê°’ë“¤ì— ë¶€ì—¬í•  ìƒ‰ìƒ ì¡°í•©|

> `hue`ëŠ” ì‹œê°ì ìœ¼ë¡œ "ëˆ„ê°€ ëˆ„êµ°ì§€" ìƒ‰ìœ¼ë¡œÂ **êµ¬ë¶„ì§“ëŠ” ê¸°ì¤€**

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/11.png" width="40%" height="40%"></p>

ê³ ìœ³ê°’ ë³„ë¡œ ë‚˜ëˆ ë´ë„ íƒ€ê²Ÿê°’ 0, 1ì˜ ë¶„í¬ê°€ ëŒ€ì²´ë¡œ 7:3 ìˆ˜ì¤€ì´ë‹¤. ì¦‰ ì´ì§„ í”¼ì²˜ë“¤ì´ íŠ¹ì • íƒ€ê²Ÿê°’ì— ì¹˜ìš°ì¹˜ì§€ ì•Šì•˜ìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


<br/>
<br/>

### 3.3. ëª…ëª©í˜• í”¼ì²˜ ë¶„í¬

ëª…ëª©í˜• í”¼ì²˜ ë¶„í¬ì™€ ëª…ëª©í˜• í”¼ì²˜ë³„ íƒ€ê²Ÿê°’ 1ì˜ ë¹„ìœ¨ì„ ì‚´í´ë³´ì. 
nom_5ë¶€í„° nom_9 í”¼ì²˜ê¹Œì§€ëŠ” ê³ ìœ ê°’ ê°œìˆ˜ê°€ ë§ê³  ì˜ë¯¸ë¥¼ ì•Œ ìˆ˜ ì—†ëŠ” ë¬¸ìì—´ì´ ì…ë ¥ë¼ ìˆê¸° ë•Œë¬¸ì— ì—¬ê¸°ì„œëŠ” nom_0 ë¶€í„° nom_4 í”¼ì²˜ê¹Œì§€ë§Œ ì‹œê°í™”í•œë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/12.jpeg" width="40%" height="40%"></p>


<br/>

#### Step1: êµì°¨ë¶„ì„í‘œ ìƒì„± í•¨ìˆ˜ ë§Œë“¤ê¸°

ìœ„ ê·¸ë¦¼ì˜ í¬ì¸íŠ¸í”Œë¡¯ì€ ëª…ëª©í˜• í”¼ì²˜ë³„ íƒ€ê²Ÿê°’ì´ 1ì¸ ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚´ëŠ” ê·¸ë˜í”„ì´ë‹¤. 
**êµì°¨í‘œ** í˜¹ì€ **êµì°¨ë¶„ì„í‘œ**ëŠ” ë²”ì£¼í˜• ë°ì´í„° 2ê°œë¥¼ ë¹„êµ ë¶„ì„í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” í‘œë¡œ, ê° ë²”ì£¼í˜• ë°ì´í„°ì˜ ë¹ˆë„ë‚˜ í†µê³„ëŸ‰ì„ í–‰ê³¼ ì—´ë¡œ ê²°í•©í•´ë†“ì€ í‘œë¥¼ ë§í•œë‹¤. 
ì—¬ê¸°ì„œ êµì°¨ë¶„ì„í‘œë¥¼ ë§Œë“œëŠ” ì´ìœ ëŠ” ëª…ëª©í˜• í”¼ì²˜ë³„ íƒ€ê²Ÿê°’ 1ì˜ ë¹„ìœ¨ì„ êµ¬í•˜ê¸° ìœ„í•¨ì´ë‹¤.

> êµì°¨ë¶„ì„í‘œë¥¼ í™œìš©í•´ ëª…ëª©í˜• í”¼ì²˜ì™€ íƒ€ê²Ÿê°’ì„ ë¹„êµ ë¶„ì„í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ì´ìš©í•´ ê·¸ë˜í”„ë¥¼ ê·¸ë¦°ë‹¤.

<br/>

##### Pandas ì˜ crosstab() í•¨ìˆ˜ë¡œ êµì°¨ë¶„ì„í‘œë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ëª…ëª©í˜• í”¼ì²˜ì¸ nom_0ì™€ íƒ€ê²Ÿê°’ ì¸ target ê°„ êµì°¨ë¶„ì„í‘œë¥¼ ë§Œë“ ë‹¤.

``` python
pd.crosstab(train['nom_0'], train['target'])
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>target</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>nom_0</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Blue</th>
      <td>72914</td>
      <td>23252</td>
    </tr>
    <tr>
      <th>Green</th>
      <td>85682</td>
      <td>41659</td>
    </tr>
    <tr>
      <th>Red</th>
      <td>49640</td>
      <td>26853</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

##### í˜„ì¬ ì¸ë±ìŠ¤ê°€ í”¼ì²˜ ì´ë¦„(nom_0)ìœ¼ë¡œ ë˜ì–´ ìˆë‹¤. ì´ë¥¼ ì—´ë¡œ ê°€ì ¸ì™€ì•¼ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê¸° í¸ê¸° ë•Œë¬¸ì— ì¸ë±ìŠ¤ë¥¼ ì¬ì„¤ì • í•œë‹¤.

``` python
crosstab = crosstab.reset_index() #ì¸ë±ìŠ¤ ì¬ì„¤ì •
crosstab
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>target</th>
      <th>nom_0</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Blue</td>
      <td>75.820976</td>
      <td>24.179024</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Green</td>
      <td>67.285478</td>
      <td>32.714522</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Red</td>
      <td>64.894827</td>
      <td>35.105173</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

##### êµì°¨ë¶„ì„í‘œ í•¨ìˆ˜í™”

``` python
def get_crosstab(df, feature):
	crosstab = pd.crosstab(df[feature], df['target'], normalize='index') * 100
	crosstab = crosstab.reset_index()
	return crosstab

crosstab = get_crosstab(train, 'nom_0')
crosstab
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>target</th>
      <th>nom_0</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Blue</td>
      <td>75.820976</td>
      <td>24.179024</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Green</td>
      <td>67.285478</td>
      <td>32.714522</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Red</td>
      <td>64.894827</td>
      <td>35.105173</td>
    </tr>
  </tbody>
</table>
</div>

<br/>
<br/>

##### í¬ì¸íŠ¸í”Œë¡¯ì€ íƒ€ê²Ÿê°’ 1ì˜ ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚´ëŠ” ê·¸ë˜í”„ì´ê¸° ë•Œë¬¸ì— 1ì¸ ë¹„ìœ¨ë§Œ ì„ íƒí•œë‹¤.

keyê°’ì˜ íƒ€ì…ì— ë”°ë¥¸ ì ‘ê·¼ ë°©ì‹

- ë¬¸ìì—´ ì»¬ëŸ¼ëª…: `df['column_name']`
  - ì˜ˆ: df['target'], df['nom_0']
  - ë°˜ë“œì‹œ ë”°ì˜´í‘œ í•„ìš”

- ìˆ«ìí˜• ì»¬ëŸ¼ëª…: `df[0]`, `df[1]`
  - intë‚˜ float íƒ€ì…ì˜ ì»¬ëŸ¼ëª…
  - ì§ì ‘ ìˆ«ìë¡œ ì ‘ê·¼
  - ë”°ì˜´í‘œ ì‚¬ìš©í•˜ë©´ KeyError ë°œìƒ

- ë³€ìˆ˜ì— ì €ì¥ëœ ì»¬ëŸ¼ëª…: `df[variable]`
  - ì˜ˆ: feature = 'nom_0'ì¼ ë•Œ df[feature]

<br>

``` python
crosstab[1]

''' ì¶œë ¥
0    24.179024
1    32.714522
2    35.105173
Name: 1, dtype: float64
'''
```

<br/>
<br/>



#### Step2: í¬ì¸íŠ¸í”Œë¡¯ ìƒì„± í•¨ìˆ˜ ë§Œë“¤ê¸°

êµì°¨ë¶„ì„í‘œë¥¼ í†µí•´ íƒ€ê²Ÿê°’ 1ì˜ ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚´ëŠ” í¬ì¸íŠ¸í”Œë¡¯ì„ ê·¸ë¦¬ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤. 

í•¨ìˆ˜ ì´ë¦„ì€ plot_pointpolt()ì´ë©° ë‹¤ìŒì˜ ì„¸ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ëŠ”ë‹¤.

- ax: í¬ì¸íŠ¸í”Œë¡¯ ê·¸ë¦´ ì¶•
- feature: í¬ì¸íŠ¸í”Œë¡¯ìœ¼ë¡œ ê·¸ë¦´ í”¼ì²˜
- crosstab: êµì°¨ë¶„ì„í‘œ

> plot_pointplot()ì€ ì´ë¯¸ ì¹´ìš´íŠ¸í”Œë¡¯ì´ ê·¸ë ¤ì§„ ì¶•ì— í¬ì¸íŠ¸í”Œë¡¯ì„ ì¤‘ë³µìœ¼ë¡œ ê·¸ë ¤ì¤€ë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/13.jpeg" width="60%" height="60%"></p>

``` python
def plot_pointplot(ax, feature, crosstab):
    ax2 = ax.twinx() # xì¶•ì€ ê³µìœ í•˜ê³  yì¶•ì€ ê³µìœ í•˜ì§€ ì•ŠëŠ” ìƒˆë¡œìš´ ì¶• ìƒì„± 
    '''
    ì¶• í•˜ë‚˜ì— ì„œë¡œ ë‹¤ë¥¸ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ë ¤ë©´ xì¶•ì„ ê³µìœ í•´ì•¼í•œë‹¤. 
    ax.twinx()ë¡œ xì¶•ì€ ê³µìœ í•˜ì§€ë§Œ yì¶•ì€ ê³µìœ í•˜ì§€ ì•ŠëŠ” ìƒˆë¡œìš´ ì¶• ax2ë¥¼ ë§Œë“ ë‹¤.
    ax2 ëŠ” í¬ì¸íŠ¸í”Œë¡¯ì„ ê·¸ë¦¬ê¸° ìœ„í•œ ì¶•ì´ë‹¤.
    '''
    
    # ìƒˆë¡œìš´ ì¶•ì— í¬ì¸íŠ¸í”Œë¡¯  ê·¸ë¦¬ê¸° 
    ax2 = sns.pointplot(x=feature, y=1, data=crosstab,
                        order=crosstab[feature].values, # í¬ì¸íŠ¸í”Œë¡¯ ìˆœì„œ
                        color='black', # í¬ë¦°íŠ¸í”Œë¡¯ ìƒ‰ìƒ
                        legend=False)  # ë²”ë¡€ ë¯¸í‘œì‹œ
    '''
    y íŒŒë¼ë¯¸í„°ì—ëŠ” íƒ€ê²Ÿê°’ì´ ì–‘ì„±(True, Yes ë“±ë“±)ì¸ ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚´ëŠ” 1, data íŒŒë¼ë¯¸í„°ì—ëŠ” êµì°¨ë¶„ì„í‘œ crosstabì„ ì „ë‹¬í•œë‹¤.
    order íŒŒë¼ë¯¸í„°ì—ëŠ” í¬ì¸íŠ¸í”Œë¡¯ì„ ê·¸ë¦´ ìˆœì„œë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. êµì°¨ë¶„ì„í‘œì˜ ì—´ ìˆœì„œëŒ€ë¡œ ê·¸ë¦¬ë„ë¡ í–ˆë‹¤. 
    (crosstab['nom_0'].values -> array(['Blue', 'Green', 'Red'], dtype=object))
    '''
    
    ax2.set_ylim(crosstab[1].min()-5, crosstab[1].max()*1.1) # yì¶• ë²”ìœ„ ì„¤ì • (ì¶”ì„¸ë¥¼ ë³´ê¸° ìœ„í•œ ì™œê³¡)
    '''
    í¬ì¸íŠ¸í”Œë¡¯ì„ ë³´ê¸° ì¢‹ê²Œ í•˜ê¸° ìœ„í•´ yì¶• ë²”ìœ„ë¥¼ ì„¤ì •í•œë‹¤. íƒ€ê²Ÿê°’ì´ 1ì¸ ë¹„ìœ¨ ì¤‘ ìµœì†Ÿê°’ì—ì„œ 5ë¥¼ ëº€ ìˆ˜ì¹˜ë¶€í„°
    ìµœëŒ“ê°’ì— 1.1ì„ ê³±í•œ ìˆ˜ì¹˜ê¹Œì§€ë¡œ ì¡ì•˜ë‹¤.
    '''
    
    ax2.set_ylabel('Target 1 Ratio(%)')
```

<br/>
<br/>

#### Step3: í”¼ì²˜ ë¶„í¬ë„ ë° í”¼ì²˜ë³„ íƒ€ê²Ÿê°’ 1ì˜ ë¹„ìœ¨ í¬ì¸íŠ¸í”Œë¡¯ ìƒì„± í•¨ìˆ˜ ë§Œë“¤ê¸°

``` python
def plot_cat_dist_with_true_ratio(df, features, num_rows, num_cols, size=(15, 20)):
    
    plt.figure(figsize=size) # ì „ì²´ Figure í¬ê¸° ì„¤ì • 
    grid = gridspec.GridSpec(num_rows, num_cols) # ì„œë¸Œí”Œë¡¯ ë°°ì¹˜ 
    '''
    ì„œë¸Œí”Œë¡¯ë“¤ì„ ê²©ì í˜•íƒœë¡œ ë°°ì¹˜í•˜ê¸° ìœ„í•´ GridSpecì„ ì‚¬ìš©í•œë‹¤.
    '''
    
    plt.subplots_adjust(wspace=0.45, hspace=0.3) # ì„œë¸Œí”Œë¡¯ ì¢Œìš°/ìƒí•˜ ì—¬ë°± ì„¤ì • 

    for idx, feature in enumerate(features): # featuresë¥¼ ìˆœíšŒí•˜ë©° ì„œë¸Œí”Œë¡¯ì„ í•˜ë‚˜ì”© ê·¸ë¦°ë‹¤.
        ax = plt.subplot(grid[idx])
        crosstab = get_crosstab(df, feature) # êµì°¨ë¶„ì„í‘œ ìƒì„±

        # axì¶•ì— íƒ€ê²Ÿê°’ ë¶„í¬ ì¹´ìš´íŠ¸í”Œë¡¯ ê·¸ë¦¬ê¸°
        sns.countplot(x=feature, data=df,
                      order=crosstab[feature].values,
                      color='skyblue',
                      ax=ax)
        
        write_percent(ax, len(df)) # ë¹„ìœ¨ í‘œì‹œ
        plot_pointplot(ax, feature, crosstab) # í¬ì¸íŠ¸í”Œë¡¯ ê·¸ë¦¬ê¸° 
        ax.set_title(f'{feature} Distribution') # ê·¸ë˜í”„ ì œëª© ì„¤ì •


nom_features = ['nom_0', 'nom_1', 'nom_2', 'nom_3', 'nom_4'] # ëª…ëª©í˜• í”¼ì²˜
plot_cat_dist_with_true_ratio(train, nom_features, num_rows=3, num_cols=2)
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/14.png" width="60%" height="60%"></p>

ì´ ê·¸ë¦¼ì—ì„œ ì¹´ìš´íŠ¸í”Œë¡¯ì€ í”¼ì²˜ë³„ ê³ ìœ³ê°’ì˜ ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚¸ë‹¤.

nom_0 í”¼ì²˜ì˜ ê³ ìœ³ê°’ì€ Blue, Green, Redì´ë©°, ì°¨ë¡€ë¡œ 32.1%, 42.4%, 25.5%ë¥¼ ì°¨ì§€í•œë‹¤. êº½ì€ ì„  ê·¸ë˜í”„ëŠ” í¬ì¸íŠ¸í”Œë¡¯ìœ¼ë¡œ, í•´ë‹¹ ê³ ìœ³ê°’ ì¤‘ íƒ€ê²Ÿê°’ì´ 1ì¸ ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚¸ë‹¤. Red ì¤‘ íƒ€ê²Ÿê°’ì´ 1ì¸ ë°ì´í„°ëŠ” 35% ì •ë„ì´ë‹¤. ë‹¹ì—°íˆ Red ì¤‘ íƒ€ê²Ÿê°’ì´ 0ì¸ ë°ì´í„°ëŠ” 65% ì •ë„ì¼ ê²ƒì´ë‹¤.

ëª…ëª©í˜• í”¼ì²˜ëŠ” ìˆœì„œë¥¼ ë¬´ì‹œí•´ë„ ë˜ê³  ê³ ìœ³ê°’ ê°¯ìˆ˜ë„ ì ì–´ ì¶”í›„ ì›-í•« ì¸ì½”ë”©í•œë‹¤.

nom_5ë¶€í„° num_9 í”¼ì²˜ëŠ” ê³ ìœ ê°’ ê°œìˆ˜ê°€ ë§ê³  ì˜ë¯¸ ì—†ëŠ” ë¬¸ìë¡œ ì´ë£¨ì–´ì ¸ ìˆì–´ ì‹œê°í™”í•˜ê¸° ì–´ë µë‹¤. ë”°ë¼ì„œ ì´ í”¼ì²˜ë“¤ì€ ì‹œê°í™” í•˜ì§€ ì•Šê³  í•„ìš”í•œ í”¼ì²˜ë¼ ê°€ì •í•˜ê³  ëª¨ë¸ë§ì— ì‚¬ìš©í•œë‹¤. ê³ ìœ³ê°’ ê°¯ìˆ˜ëŠ” ë§ì§€ë§Œ í”¼ì²˜ë“¤ì˜ ì˜ë¯¸ë¥¼ ëª°ë¼ ê·¸ë£¹í™”í•˜ê¸° ì–´ë µê³ , ì „ì²´ ë°ì´í„° ì–‘ì´ ë§ì§€ ì•Šê¸° ë•Œë¬¸ì— ì´ í”¼ì²˜ë“¤ ë˜í•œ ì›-í•« ì¸ì½”ë”©í•œë‹¤.

<br/>
<br/>
<br/>


### 3.4. ìˆœì„œí˜• í”¼ì²˜ ë¶„í¬

ìˆœì„œí˜• í”¼ì²˜ëŠ” ì´ 6ê°œì´ë©° ord_0 ë¶€í„° ord_3 ê¹Œì§€ëŠ” ê³ ìœ³ê°’ ê°œìˆ˜ê°€ 15ê°œ ì´í•˜ì¸ ë°˜ë©´, ord_4 ì™€ ord_5ëŠ” ê³ ìœ³ê°’ì´ ë§ë‹¤. ë”°ë¼ì„œ ord_0ë¶€í„° ord_3ê¹Œì§€ëŠ” 2í–‰ 2ì—´ë¡œ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê³ , ord_4ì™€ ord_5ëŠ” 2í–‰ 1ì—´ ê·¸ë˜í”„ë¡œ ê·¸ë¦°ë‹¤.

<br/>

#### ord_0 ~ ord3 í”¼ì²˜ ë¶„í¬ í™•ì¸ 

``` python
ord_features = ['ord_0', 'ord_1', 'ord_2', 'ord_3'] # ìˆœì„œí˜• í”¼ì²˜
plot_cat_dist_with_true_ratio(train, ord_features,
							  num_rows=2, num_cols=2, size=(15, 12))
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/15.png" width="60%" height="60%"></p>


> ord_1 ê³¼ ord_2 í”¼ì²˜ ê°’ë“¤ì˜ ìˆœì„œê°€ ì •ë ¬ë˜ì§€ ì•Šì•˜ë‹¤.

ord_1 í”¼ì²˜ëŠ” 'Novice', 'Contributor', 'Expert', 'Master', 'Grandmaster' ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê³ ,
ord_2 í”¼ì²˜ëŠ” 'Freezing', 'Cold', 'Hot', 'Boiling Hot', 'Lava Hot' ìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤.


<br/>
<br/>

#### CategoricalDtype()ì„ í†µí•´ í”¼ì²˜ ìˆœì„œ ì§€ì •

>CategoricalDtype()

- categories : ë²”ì£¼í˜• ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì¸ì½”ë”©í•  ê°’ ëª©ë¡
- ordered : Trueë¡œ ì„¤ì •í•˜ë©´ categoriesì— ì „ë‹¬í•œ ê°’ì˜ ìˆœì„œê°€ ìœ ì§€ëœë‹¤.

``` python
from pandas.api.types import CategoricalDtype

ord_1_value = ['Novice', 'Contributor', 'Expert', 'Master', 'Grandmaster']
ord_2_value = ['Freezing', 'Cold', 'Hot', 'Boiling Hot', 'Lava Hot']

# ìˆœì„œë¥¼ ì§€ì •í•œ ë²”ì£¼í˜• ë°ì´í„° íƒ€ì…
ord_1_dtype = CategoricalDtype(categories=ord_1_value, ordered=True)
ord_2_dtype = CategoricalDtype(categories=ord_2_value, ordered=True)

# ë°ì´í„° íƒ€ì… ë³€ê²½ 
train['ord_1'] = train['ord_1'].astype(ord_1_dtype)
train['ord_2'] = train['ord_2'].astype(ord_2_dtype)

''' ìˆœì„œë¥¼ ì§€ì •í•˜ê²Œ ë˜ë©´ ì•„ë˜ Categories í•­ëª©ì´ ì¶”ê°€ë¨
Categories (5, object): ['Novice' < 'Contributor' < 'Expert' < 'Master' < 'Grandmaster']
'''

plot_cat_dist_with_true_ratio(train, ord_features, num_rows=2, num_cols=2, size=(15, 12))
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/16.png" width="60%" height="60%"></p>

ord_0ëŠ” ìˆœì í¬ê¸° ìˆœìœ¼ë¡œ, ord_1ê³¼ ord_2ëŠ” ì§€ì •ëœ ìˆœì„œëŒ€ë¡œ, ord_3ëŠ” ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì •ë ¬ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> ì´ ê²°ê³¼ë¡œ ê³ ìœ³ê°’ ìˆœì„œì— ë”°ë¼ íƒ€ê²Ÿê°’ 1 ë¹„ìœ¨ë„ ë¹„ë¡€í•´ì„œ ì»¤ì§„ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


<br/>
<br/>

#### ord_4, ord_5 í”¼ì²˜ ë¶„í¬ í™•ì¸ 

ord_4ì™€ ord_5ì˜ ë¶„í¬ëŠ” ê³ ìœ³ê°’ ê°œìˆ˜ê°€ ë§ì•„ 2í–‰ 1ì—´ë¡œ ê·¸ë¦°ë‹¤.

``` python
plot_cat_dist_with_true_ratio(train, ['ord_4', 'ord_5'], num_rows=2, num_cols=1, size=(15, 12))
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/17.png" width="60%" height="60%"></p>

ord_5ëŠ” ê³ ìœ³ê°’ ê°œìˆ˜ê°€ ë§ì•„ xì¶• ë¼ë²¨ì´ ê²¹ì¹˜ì§€ë§Œ íƒ€ê²Ÿê°’ 1 ë¹„ìœ¨ì˜ ì „ì²´ì ì¸ ì–‘ìƒì„ ë³´ë©´ ord_4ì™€ ord_5 ëª¨ë‘ ê³ ìœ³ê°’ ìˆœì„œì— ë”°ë¼ íƒ€ê²Ÿê°’ 1 ë¹„ìœ¨ì´ ì¦ê°€í•œë‹¤.

> ëª¨ë“  ê·¸ë˜í”„ì—ì„œ ìˆœì„œì™€ ë¹„ìœ¨ ì‚¬ì´ì— ìƒê´€ê´€ê³„ê°€ ìˆìœ¼ë¯€ë¡œ ìˆœì„œí˜• í”¼ì²˜ëŠ” ëª¨ë‘ ëª¨ë¸ë§ì‹œ ì‚¬ìš©í•œë‹¤.

<br/>
<br/>
<br/>

### 3.5. ë‚ ì”¨ í”¼ì²˜ ë¶„í¬

``` python
date_feature = ['day', 'month']

plot_cat_dist_with_true_ratio(train, date_feature, num_rows=2, num_cols=1, size=(10, 10))
```


<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/18.png" width="60%" height="60%"></p>


ìš”ì¼ê³¼ ì›” í”¼ì²˜ ëª¨ë‘ ê°’ì´ ìˆ«ìì´ë‹¤. ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ ìˆ«ì ê°’ì„ ê°€ì¹˜ì˜ í¬ê³  ì‘ìŒìœ¼ë¡œ í•´ì„í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 12ì›”ê³¼ ë‹¤ìŒí•´ 1ì›”, 1ì›”ê³¼ 2ì›”ì˜ ì°¨ì´ëŠ” ë‘˜ ë‹¤ í•œë‹¬ ì°¨ì´ì´ì§€ë§Œ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ ì°¨ì´ê°€ ê°™ë‹¤ê³  ë³´ì§€ ì•ŠëŠ”ë‹¤. ì´ëŸ´ ë•Œ ì‚¼ê°í•¨ìˆ˜(sin, cos)ë¥¼ ì‚¬ìš©í•´ ì¸ì½”ë”©í•˜ë©´ ì‹œì‘ê³¼ ëì ì´ ë§¤ë„ëŸ½ê²Œ ì—°ê²°ë¼ ë¬¸ì œê°€ í•´ê²°ëœë‹¤. ì´ë ‡ê²Œ ë§¤ë…„, ë§¤ì›”, ë§¤ì£¼, ë§¤ì¼ ë°˜ë³µë˜ëŠ” ë°ì´í„°ë¥¼ ìˆœí™˜í˜• ë°ì´í„°(cyclical data)ë¼ê³  ë¶€ë¥¸ë‹¤. ê³„ì ˆ, ì›”, ìš”ì¼, ì‹œê°„ ë“±ì´ ì´ì— ì†í•œë‹¤.

> í•˜ì§€ë§Œ ì´ë²ˆ ì¥ì—ì„œëŠ” ëª…ëª©í˜• í”¼ì²˜ ë˜í•œ ì›-í•« ì¸ì½”ë”©ì„ ì ìš©í•œë‹¤.


<br/>
<br/>
<br/>


---

### ë¶„ì„ ì •ë¦¬ ë° ëª¨ë¸ë§ ì „ëµ   

#### ë¶„ì„ ì •ë¦¬

1. ê²°ì¸¡ê°’ì€ ì—†ë‹¤. 
   
2. ëª¨ë“  í”¼ì²˜ê°€ ì¤‘ìš”í•˜ë©° ì œê°€í•  í”¼ì²˜ë¥¼ ì°¾ì§€ ëª»í–ˆë‹¤.

3. **ì´ì§„ í”¼ì²˜ ì¸ì½”ë”©** : ê°’ì´ ìˆ«ìê°€ ì•„ë‹Œ ì´ì§„ í”¼ì²˜ëŠ” 0ê³¼ 1ë¡œ ì¸ì½”ë”©í•œë‹¤. 

4. **ëª…ëª©í˜• í”¼ì²˜ ì¸ì½”ë”©** : ì „ì²´ ë°ì´í„°ê°€ í¬ì§€ ì•Šìœ¼ë¯€ë¡œ ëª¨ë‘ ì›-í•« ì¸ì½”ë”©í•¨ 

5. **ìˆœì„œí˜• í”¼ì²˜ ì¸ì½”ë”©** : ê³ ìœ³ê°’ë“¤ì˜ ìˆœì„œì— ë§ê²Œ ì¸ì½”ë”©í•œë‹¤.(ì´ë¯¸ ìˆ«ìë¡œ ë˜ì–´ ìˆë‹¤ë©´ ì¸ì½”ë”© í•„ìš” ì—†ìŒ)

6. **ë‚ ì§œ í”¼ì²˜ ì¸ì½”ë”©** : ê°’ì˜ í¬ê³  ì‘ìŒìœ¼ë¡œ í•´ì„ë˜ì§€ ëª»í•˜ë„ë¡ ì›-í•« ì¸ì½”ë”©

<br/>

#### ëª¨ë¸ë§ ì „ëµ 

ì´ë²ˆ ëŒ€íšŒ ì°¸ê°€ ëª©í‘œëŠ” ë°ì´í„° íŠ¹ì„±ì— ë”°ë¥¸ ë§ì¶¤í˜• ì¸ì½”ë”© ë°©ë²•ì„ ìµíˆëŠ”ê²ƒì´ë‹¤. 
ë”°ë¼ì„œ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ ê¸°ë³¸ì ì¸ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ ê³„ì† ì‚¬ìš©í•˜ë©´ì„œ í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ì— ì§‘ì¤‘í•œë‹¤. 
ê·¸ ì™¸ ì´ìš©í•  ìˆ˜ ìˆëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” ë“±ì˜ ì„±ëŠ¥ ê°œì„  ë°©ë²•ì„ í•™ìŠµí•œë‹¤. 

- **ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸** : ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ 
	- **í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§** : ëª¨ë“  í”¼ì²˜ë¥¼ ì›-í•« ì¸ì½”ë”©

- **ì„±ëŠ¥ ê°œì„ ** : ì¶”ê°€ í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ê³¼ í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”
	- **í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§** : í”¼ì²˜ ë§ì¶¤ ì¸ì½”ë”©ê³¼ í”¼ì²˜ ìŠ¤ì¼€ì¼ë§ 
	- **í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”** : ê·¸ë¦¬ë“œ ì„œì¹˜
	- **ì¶”ê°€ íŒ** : ê²€ì¦ ë°ì´í„°ë¥¼ í›ˆë ¨ì— ì´ìš©

<br/>
<br/>
<br/>

---

## 4. ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ 

> ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ ì „ì²´ í”„ë¡œì„¸ìŠ¤ 

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/19.jpeg" width="70%" height="70%"></p>

<br/>

#### ë°ì´í„° ë¡œë“œ

``` python
import pandas as pd

data_path = 'datasets/'

train = pd.read_csv(data_path + 'train.csv', index_col='id')
test = pd.read_csv(data_path + 'test.csv', index_col='id')
submission = pd.read_csv(data_path + 'sample_submission.csv', index_col='id')
```

<br/>
<br/>

### 4.1 í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§

#### ë°ì´í„° í•©ì¹˜ê¸° 

ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ ë¬¸ì ë°ì´í„°ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•œë‹¤. ë”°ë¼ì„œ ë¬¸ìë¥¼ ìˆ«ìë¡œ ë°”ê¿”ì•¼í•œë‹¤.

ì´ì²˜ëŸ¼ ë°ì´í„°ì˜ í‘œí˜„ í˜•íƒœë¥¼ ë°”ê¾¸ëŠ” ì‘ì—…ì„ ì¸ì½”ë”©ì´ë¼ê³  í•œë‹¤.

í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ë™ì¼í•œ ì¸ì½”ë”©ì„ ìœ„í•´ ë‘˜ì´ í•©ì¹œ ë‹¤ìŒ DataFrameì—ì„œ íƒ€ê²Ÿê°’ì„ ì œê±°í•œë‹¤.

``` python
import pandas as pd

all_data = pd.concat([train, test])
all_data = all_data.drop(['target'], axis=1)

all_data
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bin_0</th>
      <th>bin_1</th>
      <th>bin_2</th>
      <th>bin_3</th>
      <th>bin_4</th>
      <th>nom_0</th>
      <th>nom_1</th>
      <th>nom_2</th>
      <th>nom_3</th>
      <th>nom_4</th>
      <th>...</th>
      <th>nom_8</th>
      <th>nom_9</th>
      <th>ord_0</th>
      <th>ord_1</th>
      <th>ord_2</th>
      <th>ord_3</th>
      <th>ord_4</th>
      <th>ord_5</th>
      <th>day</th>
      <th>month</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>T</td>
      <td>Y</td>
      <td>Green</td>
      <td>Triangle</td>
      <td>Snake</td>
      <td>Finland</td>
      <td>Bassoon</td>
      <td>...</td>
      <td>c389000ab</td>
      <td>2f4cb3d51</td>
      <td>2</td>
      <td>Grandmaster</td>
      <td>Cold</td>
      <td>h</td>
      <td>D</td>
      <td>kr</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>T</td>
      <td>Y</td>
      <td>Green</td>
      <td>Trapezoid</td>
      <td>Hamster</td>
      <td>Russia</td>
      <td>Piano</td>
      <td>...</td>
      <td>4cd920251</td>
      <td>f83c56c21</td>
      <td>1</td>
      <td>Grandmaster</td>
      <td>Hot</td>
      <td>a</td>
      <td>A</td>
      <td>bF</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>F</td>
      <td>Y</td>
      <td>Blue</td>
      <td>Trapezoid</td>
      <td>Lion</td>
      <td>Russia</td>
      <td>Theremin</td>
      <td>...</td>
      <td>de9c9f684</td>
      <td>ae6800dd0</td>
      <td>1</td>
      <td>Expert</td>
      <td>Lava Hot</td>
      <td>h</td>
      <td>R</td>
      <td>Jc</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>F</td>
      <td>Y</td>
      <td>Red</td>
      <td>Trapezoid</td>
      <td>Snake</td>
      <td>Canada</td>
      <td>Oboe</td>
      <td>...</td>
      <td>4ade6ab69</td>
      <td>8270f0d71</td>
      <td>1</td>
      <td>Grandmaster</td>
      <td>Boiling Hot</td>
      <td>i</td>
      <td>D</td>
      <td>kW</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>F</td>
      <td>N</td>
      <td>Red</td>
      <td>Trapezoid</td>
      <td>Lion</td>
      <td>Canada</td>
      <td>Oboe</td>
      <td>...</td>
      <td>cb43ab175</td>
      <td>b164b72a7</td>
      <td>1</td>
      <td>Grandmaster</td>
      <td>Freezing</td>
      <td>a</td>
      <td>R</td>
      <td>qP</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>499995</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>F</td>
      <td>N</td>
      <td>Green</td>
      <td>Square</td>
      <td>Lion</td>
      <td>Canada</td>
      <td>Theremin</td>
      <td>...</td>
      <td>9e4b23160</td>
      <td>acc31291f</td>
      <td>1</td>
      <td>Novice</td>
      <td>Lava Hot</td>
      <td>j</td>
      <td>A</td>
      <td>Gb</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>499996</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>F</td>
      <td>Y</td>
      <td>Green</td>
      <td>Trapezoid</td>
      <td>Lion</td>
      <td>China</td>
      <td>Piano</td>
      <td>...</td>
      <td>cfbd87ed0</td>
      <td>eae3446d0</td>
      <td>1</td>
      <td>Contributor</td>
      <td>Lava Hot</td>
      <td>f</td>
      <td>S</td>
      <td>Ed</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>499997</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>T</td>
      <td>Y</td>
      <td>Green</td>
      <td>Trapezoid</td>
      <td>Lion</td>
      <td>Canada</td>
      <td>Oboe</td>
      <td>...</td>
      <td>1108bcd6c</td>
      <td>33dd3cf4b</td>
      <td>1</td>
      <td>Novice</td>
      <td>Boiling Hot</td>
      <td>g</td>
      <td>V</td>
      <td>TR</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>499998</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>T</td>
      <td>Y</td>
      <td>Blue</td>
      <td>Star</td>
      <td>Hamster</td>
      <td>Costa Rica</td>
      <td>Bassoon</td>
      <td>...</td>
      <td>606ac930b</td>
      <td>d4cf587dd</td>
      <td>2</td>
      <td>Grandmaster</td>
      <td>Boiling Hot</td>
      <td>g</td>
      <td>X</td>
      <td>Ye</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>499999</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>T</td>
      <td>Y</td>
      <td>Green</td>
      <td>Star</td>
      <td>Lion</td>
      <td>India</td>
      <td>Piano</td>
      <td>...</td>
      <td>4ea576eb6</td>
      <td>2d610f52c</td>
      <td>2</td>
      <td>Novice</td>
      <td>Freezing</td>
      <td>l</td>
      <td>J</td>
      <td>ex</td>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>500000 rows Ã— 23 columns</p>
</div>


<br/>
<br/>

#### ì›-í•« ì¸ì½”ë”© 

ë¬¸ìë¡œ êµ¬ì„±ëœ í”¼ì²˜ëŠ” ëª¨ë¸ì´ í›ˆë ¨ì„ í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë°˜ë“œì‹œ ì¸ì½”ë”© í•´ì•¼í•œë‹¤. ë°˜ë©´ ìˆ«ìë¡œ êµ¬ì„±ëœ í”¼ì²˜ëŠ” ë°˜ë“œì‹œ ì¸ì½”ë”© í•  í•„ìš”ëŠ” ì—†ë‹¤.

ë‹¨, ëª¨ë¸ ì„±ëŠ¥ì„ ë” ì¢‹ê²Œ í•˜ê¸° ìœ„í•´ ìˆ«ìë¡œ êµ¬ì„±ëœ ë²”ì£¼í˜• í”¼ì²˜ë„ ì¸ì½”ë”© í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤.

ì—¬ê¸°ì„œëŠ” í¸ì˜ìƒ ëª¨ë“  í”¼ì²˜ë¥¼ ì¸ì½”ë”© í•˜ë©°, ëª¨ë¸ ì„±ëŠ¥ ê°œì„ ì—ì„œ í”¼ì²˜ì˜ íŠ¹ì„±ì— ë”°ë¼ ë‹¤ë¥¸ ì¸ì½”ë”©ì„ ì ìš©í•œë‹¤.

``` python
from sklearn.preprocessing import OneHotEncoder

encoder = OneHotEncoder() # ì›-í•« ì¸ì½”ë” ê°ì²´ ìƒì„±

all_data_encoded = encoder.fit_transform(all_data) # ì›-í•« ì¸ì½”ë”© ì ìš©
```

<br/>

#### Train, Test, target ë°ì´í„° ë‚˜ëˆ„ê¸°

í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶„ë¦¬í•œë‹¤. ì—¬ê¸°ì„œëŠ” í–‰ ë²ˆí˜¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ì‹œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.

``` python
num_train = len(train) # í›ˆë ¨ ë°ì´í„° ê°œìˆ˜

# í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„° ë‚˜ëˆ„ê¸°
X_train = all_data_encoded[:num_train]
X_test = all_data_encoded[num_train:]  

y = train['target']
```

<br/>

#### train_test_split í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ train, val ë°ì´í„° ë¶„ë¦¬

ê²€ì¦ ë°ì´í„°ë¥¼ ì´ìš©í•´ ì œì¶œ ì „ ëª¨ë¸ ì„±ëŠ¥ì„ í‰ê°€í•œë‹¤. ì´ë¥¼ í†µí•´ ì–´ë–¤ê±¸ ìˆ˜ì •í–ˆì„ ë•Œ ëª¨ë¸ ì„±ëŠ¥ì´ ì¢‹ì•„ì¡ŒëŠ”ì§€ ê°€ëŠ í•  ìˆ˜ ìˆë‹¤.

``` python
from sklearn.model_selection import train_test_split

# í›ˆë ¨ ë°ì´í„°, ê²€ì¦ ë°ì´í„° ë¶„ë¦¬
X_train, X_valid, y_train, y_valid = train_test_split(X_train, y,
													  test_size = 0.1,
													  stratify=y,
													  random_state=10)
```

train_test_split()ì€ ì „ì²´ ë°ì´í„°ë¥¼ í›ˆë ¨ ë°ì´í„°ì™€ ê²€ì¦(í˜¹ì€ í…ŒìŠ¤íŠ¸) ë°ì´í„°ë¡œ ë‚˜ëˆ„ëŠ” í•¨ìˆ˜ì´ë‹¤.

ì²«ë²ˆì§¸ ì¸ìˆ˜ë¡œëŠ” í”¼ì²˜(X_train)ë¥¼, ë‘ë²ˆì§¸ ì¸ìˆ˜ë¡œëŠ” íƒ€ê²Ÿê°’(y)ì„ ì „ë‹¬í•œë‹¤. 

test_sizeëŠ” ê²€ì¦ ë°ì´í„° í¬ê¸°ë¥¼ ì§€ì •í•˜ëŠ” íŒŒë¼ë¯¸í„°ì´ë‹¤. ê°’ì´ ì •ìˆ˜ë©´ ê²€ì¦ ë°ì´í„°ì˜ ê°¯ìˆ˜ë¥¼, ì‹¤ìˆ˜ë©´ ë¹„ìœ¨ì„ ì˜ë¯¸í•œë‹¤. ì—¬ê¸°ì„œëŠ” 0.1ì„ ì „ë‹¬í–ˆìœ¼ë¯€ë¡œ 10%ë¥¼ ê²€ì¦ ë°ì´í„°ë¡œ ë¶„ë¦¬í•˜ê² ë‹¤ëŠ” ëœ»ì´ë‹¤.

stratifyëŠ” íŒŒë¼ë¯¸í„°ë¡œ ì§€ì •í•œ ê°’ì„ ê° ê·¸ë£¹ì— ê³µì •í•˜ê²Œ ë°°ë¶„í•œë‹¤. ì—¬ê¸°ì„œëŠ” íƒ€ê²Ÿê°’ì¸ yë¥¼ ì „ë‹¬í–ˆìœ¼ë¯€ë¡œ íƒ€ê²Ÿê°’ì´ í›ˆë ¨ ë°ì´í„°ì™€ ê²€ì¦ ë°ì´í„°ì— ê°™ì€ ë¹„ìœ¨ë¡œ í¬í•¨ë˜ê²Œë” ë‚˜ëˆ ì¤€ë‹¤. stratify íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ í›ˆë ¨ ë°ì´í„°ì™€ ê²€ì¦ ë°ì´í„°ì— íƒ€ê²Ÿê°’ì´ ë¶ˆê· í˜•í•˜ê²Œ ë¶„í¬ ë  ìˆ˜ ìˆê³ , ê·¸ë ‡ê²Œ ë˜ë©´ í›ˆë ¨ê³¼ ê²€ì¦ì´ ì˜¬ë°”ë¥´ê²Œ ì´ë£¨ì–´ì§€ì§€ ì•Šìœ¼ë¯€ë¡œ ë˜ë„ë¡ì´ë©´ stratify íŒŒë¼ë§ˆë¯¸í„°ì— íƒ€ê²Ÿê°’ì„ ë„˜ê²¨ì£¼ëŠ”ê²Œ ë°”ëŒì§í•˜ë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/20.jpeg" width="60%" height="60%"></p>

> ê²€ì¦ ë°ì´í„°ëŠ” ëŒ€ì²´ë¡œ 10~20% ì •ë„ë¡œ ì¡ëŠ”ë‹¤.

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/21.jpeg" width="70%" height="70%"></p>

<br/>
<br/>
<br/>

### 4.2 ëª¨ë¸ í›ˆë ¨ 

#### ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ ìƒì„± ë° í›ˆë ¨

- ìµœëŒ€ ì—í­: 1000
- ì‹œë“œê°’: 42

``` python
from sklearn.linear_model import LogisticRegression

logistic_model = LogisticRegression(max_iter=1000, random_state=42)
logistic_model.fit(X_train, y_train)
```

<br/>
<br/>

### 4.3 ëª¨ë¸ ì„±ëŠ¥ ê²€ì¦

ì‚¬ì´í‚·ëŸ°ì€ íƒ€ê²Ÿê°’ ì˜ˆì¸¡ ë©”ì„œë“œë¡œ predict()ì™€ predict_proba() ë‘ ê°€ì§€ë¥¼ ì œê³µí•œë‹¤.

- predict(): íƒ€ê²Ÿê°’ ìì²´(0ì´ëƒ 1ì´ëƒ)ë¥¼ ì˜ˆì¸¡
- predict_proba(): íƒ€ê²Ÿê°’ì˜ í™•ë¥ (0ì¼ í™•ë¥ ê³¼ 1ì¼ í™•ë¥ )ì„ ì˜ˆì¸¡

<br/>

#### predict_proba() ë©”ì„œë“œë¡œ íƒ€ê²Ÿê°’ ì˜ˆì¸¡

``` python
logistic_model.predict_proba(X_valid)

''' ì¶œë ¥
array([[0.22992663, 0.77007337],
       [0.91391701, 0.08608299],
       [0.8251393 , 0.1748607 ],
       ...,
       [0.25365496, 0.74634504],
       [0.49236783, 0.50763217],
       [0.95856154, 0.04143846]])
'''
```

ì²« ë²ˆì§¸ ì—´ì€ íƒ€ê²Ÿê°’ì´ 0ì¼ í™•ë¥ ì„ ë‚˜íƒ€ë‚´ê³  ë‘ ë²ˆì§¸ ì—´ì€ 1ì¼ í™•ë¥ ì„ ë‚˜íƒ€ë‚¸ë‹¤.

> ë‹¹ì—°íˆ ë‘ ê°’ì„ í•©í•˜ë©´ 1ì´ ëœë‹¤.


<br/>
<br/>

#### predict() ë©”ì„œë“œë¡œ íƒ€ê²Ÿê°’ ì˜ˆì¸¡

``` python
logistic_model.predict(X_valid)

''' ì¶œë ¥
array([1, 0, 0, ..., 1, 1, 0])
'''
```

0 ë˜ëŠ” 1ë¡œ ì˜ˆì¸¡í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. predict_proba()ë¡œ ì˜ˆì¸¡í•œ ê²°ê³¼ì™€ ë¹„êµí•´ë³´ë©´, ì²« í–‰ì˜ íƒ€ê²Ÿê°’ì´ 0ì¼ í™•ë¥ ì€ 0.2299ì´ê³ , 1ì¼ í™•ë¥ ì€ 0.7700ì´ë‹¤. 1ì¼ í™•ë¥ ì´ ë” í¬ë‹¤.

ë”°ë¼ì„œ  predict()ëŠ” íƒ€ê²Ÿê°’ì„ 1ë¡œ ì˜ˆì¸¡í–ˆë‹¤. ë‚˜ë¨¸ì§€ í–‰ë„ ë§ˆì°¬ê°€ì§€ ì´ë‹¤.


> ë³¸ ëŒ€íšŒì—ì„œëŠ” íƒ€ê²Ÿê°’ì´ 1ì¼ 'í™•ë¥ ' ì„ ì˜ˆì¸¡í•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ predict_proba()ë¡œ ì˜ˆì¸¡í•œ ê²°ê³¼ì˜ ë‘ë²ˆì§¸ ì—´ì„ íƒ€ê²Ÿ ì˜ˆì¸¡ê°’ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.


<br/>
<br/>

#### predict_proba() ë©”ì„œë“œë¡œ íƒ€ê²Ÿê°’ì´ 1ì¼ í™•ë¥ ë§Œ ì¶”ì¶œ

``` python
y_valid_preds = logistic_model.predict_proba(X_valid)[:, 1]
```

y_valid_preds ë³€ìˆ˜ì—ëŠ” ê²€ì¦ ë°ì´í„° íƒ€ê²Ÿê°’ì´ 1ì¼ í™•ë¥ ì´ ì €ì¥ëœë‹¤.


<br/>
<br/>

#### íƒ€ê²Ÿ ì˜ˆì¸¡ê°’ì¸ y_valid_preds ì™€ ì‹¤ì œ íƒ€ê²Ÿê°’ì¸ y_validë¥¼ ì´ìš©í•´ ROC AUC ê³„ì‚°

ROC AUC ì ìˆ˜ëŠ” ì‚¬ì´í‚·ëŸ°ì˜ roc_auc_score() ë¥¼ í†µí•´ êµ¬í•  ìˆ˜ ìˆë‹¤.

``` python
from sklearn.metrics import roc_auc_score

# ê²€ì¦ ë°ì´í„° ROC AUC
roc_auc = roc_auc_score(y_valid, y_valid_preds)

print(f'ê²€ì¦ ë°ì´í„° ROC AUC: {roc_auc:.4f}')


''' ì¶œë ¥ 
ê²€ì¦ ë°ì´í„° ROC AUC: 0.7965
'''
```

<br/>
<br/>

> **ROC AUC**

- > ë¶„ë¥˜(Classification) ë¬¸ì œì—ì„œ ì‚¬ìš©
- ROC CurveëŠ”Â **FPR(False Positive Rate)**Â vsÂ **TPR(True Positive Rate)**Â ê·¸ë˜í”„
- AUCëŠ” ê·¸ ê³¡ì„  ì•„ë˜ ë©´ì ì„ ë§í•¨ (0.5~1 ì‚¬ì´)

- ì‚¬ìš©:
	- **ì´ì§„ ë¶„ë¥˜(binary classification)**Â ë¬¸ì œì—ì„œ
	- íŠ¹íˆÂ **í´ë˜ìŠ¤ ë¶ˆê· í˜•(ë¶ˆëŸ‰:ì •ìƒ=1:100 ê°™ì€)**Â ìƒí™©ì—ì„œ ìœ ìš©

- íŠ¹ì§•:
	- **í™•ë¥  ì˜ˆì¸¡ì´ ì •í™•í• ìˆ˜ë¡ ë†’ì€ ì ìˆ˜**
	- **í´ë˜ìŠ¤ ê°„ ìˆœì„œ(rank)** ì— ê¸°ë°˜ (ì˜ˆì¸¡ì´ 1ì— ê°€ê¹Œìš´ ìƒ˜í”Œì´ ì‹¤ì œë¡œ 1ì´ëƒë¥¼ ë´„)
	- ì •í™•ë„(accuracy)ë³´ë‹¤Â **ì„ê³„ê°’ì— ëœ ë¯¼ê°**

<br/>
<br/>

**Accuracy** vs **F1 Score** vs **ROC AUC**

| í•­ëª©         | **Accuracy**<br>(ì •í™•ë„)                      | **F1 Score**<br>(ì •ë°€ë„+ì¬í˜„ìœ¨ ê· í˜•)                   | **ROC AUC**<br>(ìˆœìœ„ ì •ë ¬ ëŠ¥ë ¥)               |
| ---------- | ------------------------------------------ | ---------------------------------------------- | --------------------------------------- |
| **ëœ»**      | ì „ì²´ ì¤‘ì—ì„œÂ **ë§ì¶˜ ë¹„ìœ¨**                           | **ì¤‘ìš”í•œ ì •ë‹µ(ì–‘ì„±)**ì„ ì–¼ë§ˆë‚˜Â **ì •í™•í•˜ê³  ë†“ì¹˜ì§€ ì•Šì•˜ëŠ”ì§€**Â ë³´ëŠ” ì ìˆ˜    | ì •ë‹µì´ 1ì¼ ê°€ëŠ¥ì„±ì´ ë†’ì€Â **ìˆœì„œë¥¼ ì–¼ë§ˆë‚˜ ì˜ ë§¤ê²¼ëŠ”ì§€**Â ë³´ëŠ” ì ìˆ˜ |
| **ì‚¬ìš© ì˜ˆì‹œ**  | ì‹œí—˜ì—ì„œ ëª‡ ë¬¸ì œ ë§ì·„ëŠ”ì§€                             | ì•” í™˜ì ì˜ˆì¸¡ì—ì„œ ì§„ì§œ í™˜ìë“¤ì„Â **ì •í™•í•˜ê²Œ**Â ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥             | ì•” í™˜ìì¼ í™•ë¥ ì´ ë†’ì€ ì‚¬ëŒì„Â **ìˆœì„œëŒ€ë¡œ ì¤„ ì„¸ìš°ëŠ” ëŠ¥ë ¥**      |
| **ê¸°ì¤€**     | ë‹¨ìˆœíˆ ì˜ˆì¸¡ ê²°ê³¼(0 ë˜ëŠ” 1)ê°€Â **ë§ì•˜ëŠ”ì§€**Â ì—¬ë¶€             | ì •ë‹µì´ 1ì¼ ë•Œ ì–¼ë§ˆë‚˜ ì˜Â **ë§íˆê³ **, ì–¼ë§ˆë‚˜Â **ëœ í‹€ë ¸ëŠ”ì§€**         | ì •ë‹µì´ 1ì¼ìˆ˜ë¡ í™•ë¥ ì„ ë”Â **ë†’ê²Œ ì£¼ì—ˆëŠ”ì§€**Â (ìˆœìœ„ ê¸°ì¤€)      |
| **ëª©ì **     | ì˜ˆì¸¡ì´ ì–¼ë§ˆë‚˜ ë§ì´ ë§ì•˜ë‚˜                             | ì¤‘ìš” í´ë˜ìŠ¤(ì–‘ì„±)ë¥¼Â **ì •í™•íˆ ë§ì¶”ëŠ” ê²Œ ì¤‘ìš”í•  ë•Œ**                | í™•ë¥  ì˜ˆì¸¡ì„ ì˜í•´ì„œ, ì¤‘ìš”í•œ ê±¸Â **ë¨¼ì € ì°¾ëŠ” ê²Œ ì¤‘ìš”í•  ë•Œ**     |
| **ì£¼ì˜ì **    | **í´ë˜ìŠ¤ê°€ ì¹˜ìš°ì³ ìˆìœ¼ë©´**Â ì˜ë¯¸ ì—†ìŒ (ì˜ˆ: ì „ë¶€ 0ë§Œ ì˜ˆì¸¡í•´ë„ 90%) | ì •ë°€ë„(Precision), ì¬í˜„ìœ¨(Recall) ì¤‘Â **ë¬´ì—‡ì´ ë‚®ì€ì§€ ì•ˆ ë³´ì„** | ì‹¤ì œ ì •ë‹µì´ ë­”ì§€ëŠ” ëª°ë¼ë„,Â **ìˆœì„œë§Œ ë§ì¶°ë„ ì ìˆ˜ëŠ” ë†’ì„ ìˆ˜ ìˆìŒ** |
| **ì–¸ì œ ìœ ìš©?** | ê²°ê³¼ë¥¼ ê·¸ëƒ¥Â **0/1ë¡œ ì“¸ ìˆ˜ ìˆì„ ë•Œ**                   | ì •ë‹µì´ 1ì¸ ê±¸Â **ë†“ì¹˜ë©´ ì•ˆ ë˜ëŠ” ê²½ìš°**(ì˜ë£Œ, ë³´ì•ˆ ë“±)             | ìš°ì„ ìˆœìœ„ë§Œ ì¤‘ìš”í•˜ê±°ë‚˜Â **ì„ê³„ê°’ ì •í•˜ê¸° ì „**Â ëª¨ë¸ ë¹„êµí•  ë•Œ      |
| Â **ì ìˆ˜ í•´ì„** | 1.0 = ì „ë¶€ ë§ì¶¤  <br>0.0 = ì „ë¶€ í‹€ë¦¼               | 1.0 = ì¤‘ìš” ì •ë‹µ ì˜ ë§ì¶¤  <br>0.0 = ì „í˜€ ëª» ë§ì¶¤            | 1.0 = ìˆœì„œë¥¼ ì™„ë²½íˆ ë§ì¶¤  <br>0.5 = ëœë¤ê³¼ ë™ì¼      |


<br/>

> ì˜ˆì‹œ ìƒí™©

ì˜ˆ: 100ëª… ì¤‘ 5ëª…ì´ ì•” í™˜ìì¸ ë°ì´í„°ë¥¼ ëª¨ë¸ì´ ì˜ˆì¸¡í–ˆë‹¤ê³  ê°€ì •.

- **Accuracy = 95%**  
    ğŸ‘‰ ê·¸ëƒ¥ ì „ë¶€ â€œì•” ì•„ë‹ˆë‹¤â€ë¼ê³  ì˜ˆì¸¡í•´ë„ 95% ë§ì¶˜ ê²ƒì²˜ëŸ¼ ë³´ì„ âŒ
    
- **F1 Score = 0.0**  
    ğŸ‘‰ ì‹¤ì œ ì•” í™˜ìë¥¼Â **í•˜ë‚˜ë„ ëª» ë§ì¶”ë©´**Â F1ì€ 0ì 
    
- **ROC AUC = 0.5**  
    ğŸ‘‰ ì•” í™˜ìì—ê²Œ ë†’ì€ í™•ë¥ ì„ ì•ˆ ì¤¬ë‹¤ë©´,Â **ëœë¤ì´ë‚˜ ë‹¤ë¦„ì—†ìŒ**


<br/>
<br/>

### 4.4 ì˜ˆì¸¡ ë° ê²°ê³¼ ì œì¶œ 

#### í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ í™œìš©í•´ íƒ€ê²Ÿê°’ì´ 1ì¼ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ê³ , ê²°ê³¼ ì œì¶œ

``` python
# íƒ€ê²Ÿê°’ì´ 1ì¼ í™•ë¥  ì˜ˆì¸¡
y_preds = logistic_model.predict_proba(X_test)[:, 1]

# ì œì¶œ íŒŒì¼ ìƒì„±
submission['target'] = y_preds
submission.to_csv('submission.csv')
```

``` python
!kaggle competitions submit -c cat-in-the-dat -f submission.csv -m "Message"
```

``` zsh
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5.07M/5.07M [00:02<00:00, 2.28MB/s]
Successfully submitted to Categorical Feature Encoding Challenge
```

<p align="center"><img src="https://tera.dscloud.me:8080/Images/MachineLearningê¸°ì´ˆ/Part3/2.Categorical_Feature_Encoding_Challenge/22.png" width="90%" height="90%"></p>


í”„ë¼ì´ë¹— ì ìˆ˜ëŠ” 0.79612, í¼ë¸”ë¦­ ì ìˆ˜ëŠ” 0.80108 ì´ ë‚˜ì˜¨ë‹¤.

í”„ë¼ì´ë¹— ì ìˆ˜ëŠ” ëŒ€í™”ê°€ ì¢…ë£Œëœ í›„ ì „ì²´ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ í‰ê°€í•œ ì ìˆ˜ì´ë‹¤. ë°˜ë©´ í¼ë¸”ë¦­ ì ìˆ˜ëŠ” ëŒ€íšŒê°€ ì¢…ë£Œë˜ê¸° ì „, í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¼ë¶€ë§Œ ì‚¬ìš©í•´ í‰ê°€í•œ ì ìˆ˜ì´ë‹¤.

í”„ë¼ì´ë¹— ì ìˆ˜ê°€ ìµœì¢… ì ìˆ˜ì´ë©°, í¼ë¸”ë¦­ ì ìˆ˜ëŠ” í° ì˜ë¯¸ê°€ ì—†ë‹¤.

Leaderboard ë©”ë‰´ì—ì„œ í™•ì¸í•´ë³´ë©´ í”„ë¼ì´ë¹— ì ìˆ˜ ê¸°ì¤€ ìƒìœ„ 52.7%ë¡œ ê·¸ë‹¤ì§€ ì¢‹ì§€ ì•Šì€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br/>
<br/>
<br/>

---

## 5. ì„±ëŠ¥ ê°œì„  I

ìì „ê±° ëŒ€ì—¬ ìˆ˜ìš” ì˜ˆì¸¡ ë¬¸ì œ ì—ì„œëŠ” ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ê³¼ ë‹¤ë¥¸ ëª¨ë¸ì„ ì‚¬ìš©í•´ ë” ë†’ì€ ì„±ëŠ¥ì„ ì–»ì—ˆì§€ë§Œ, ì´ë²ˆ ë¬¸ì œì—ì„œëŠ” ë² ì´ìŠ¤ ë¼ì¸ ëª¨ë¸ ìì²´ì˜ ì„±ëŠ¥ì„ ë†’ì¸ë‹¤.

